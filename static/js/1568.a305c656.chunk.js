"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[1568],{84618:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(99932),i=t(78450),o=t(52398),s=t(17969),a=t(74482),c=t(25624),l=(t(2028),t(99350)),u=t(9703),d=t(2898),p=(t(3641),t(70289));function f(e){var n=e.open,t=e.onClose,f=e.onResetPassword,x=e.type,h=e.ticket,m=e.clientApi,v=e.mutate,g=void 0===v?function(){}:v,Z=e.closeAll,b=(0,d.Z)().t,y=(0,s.useState)(!1),w=(0,o.Z)(y,2),j=w[0],k=w[1],S=(0,s.useState)({}),C=(0,o.Z)(S,2),P=(C[0],C[1],(0,s.useState)({})),D=(0,o.Z)(P,2),T=(D[0],D[1],(0,s.useState)(!1)),N=(0,o.Z)(T,2),L=(N[0],N[1],(0,l.Ds)().enqueueSnackbar),W=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,k(!0),"positions"!==x){e.next=15;break}if(Z){e.next=9;break}return e.next=6,null===m||void 0===m?void 0:m.closePosition(h);case 6:n=e.sent,e.next=13;break;case 9:return console.log("aaaaa"),e.next=12,null===m||void 0===m?void 0:m.closeAll();case 12:n=e.sent;case 13:e.next=24;break;case 15:if(Z){e.next=21;break}return e.next=18,null===m||void 0===m?void 0:m.cancelOrder(h);case 18:n=e.sent,e.next=24;break;case 21:return e.next=23,null===m||void 0===m?void 0:m.cancelAll();case 23:n=e.sent;case 24:return console.log(n),e.next=27,g();case 27:L(b("positions"===x?"tradeCloseSuccess":"tradeCancelSuccess"),{variant:"success"}),k(!1),t(),e.next=36;break;case 32:e.prev=32,e.t0=e.catch(0),k(!1),"incorrectPassword"===e.t0.message?(L(b("incorrectPassword"),{variant:"error"}),t(),f()):L(b(e.t0.message),{variant:"error"});case 36:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return(0,p.jsx)(u.ZP,{open:n,onClose:t,save:W,saveLoading:j,children:(0,p.jsx)(a.Z,{sx:{width:400,mx:"auto",textAlign:"center"},children:(0,p.jsx)(c.Z,{sx:{mb:2,fontSize:18},children:b(Z?"positions"===x?"whetherToCloseAll":"cancelPendingAll":"positions"===x?"whetherToClose":"cancelPending")})})})}},8675:function(e,n,t){t(17969);var r=t(3536),i=t(1532),o=t(70289);n.Z=function(e){var n=e.loading;return(0,o.jsx)(r.Z,{sx:{zIndex:"9999999"},open:n,children:(0,o.jsx)(i.Z,{})})}},56039:function(e,n,t){t.d(n,{b:function(){return a}});var r=t(58173),i=t(17969),o=t(69580),s=t(72667),a=function(e){(0,s.Z)(e);var n=(0,o.Z)();(0,i.useEffect)((function(){if(!(0,r.isNil)(e)&&0!==e.length){var t=s.H.subscribe((function(e){var t=e.response;console.log("watch symbols",t.map((function(e){return e.symbol}))),n.watch(t.map((function(e){return e.symbol})))}));return function(){t&&t(),n.unwatch()}}n.unwatch()}),[e])}},69580:function(e,n,t){t.d(n,{Q:function(){return p}});var r=t(99932),i=t(78450),o=t(24572),s=t(75782),a=t(17969),c=t(70858),l=t(53707),u=t(14517),d=t(72667),p=(0,u.ZP)((function(e,n){return{response:{}}})),f=c.url.join("wss://mt4-api.decodeex.com/","/"),x=new l.Z(f,(function(e){var n=JSON.parse(e.data),t=n.s,r=n.b,i=n.a,a=n.o;n.h,n.l,n.c,n.v;null==a&&p.setState({response:(0,s.Z)((0,s.Z)({},p.getState().response),{},(0,o.Z)({},t,(0,s.Z)((0,s.Z)({},p.getState().response[t]||{}),{},(0,o.Z)({},"std",{bid:r,ask:i}),d.H.getState().KVResponse[t]||{})))})}));n.Z=function(){var e=(0,a.useMemo)((function(){return{watch:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"subm",ls:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),unwatch:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"unsubm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),watchQuote:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"subm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),unwatchQuote:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"unsubm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),watchHist:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"ohlc"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),unwatchHist:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.send_({c:"unohlc"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}),[]);return e}},72667:function(e,n,t){t.d(n,{H:function(){return l}});var r=t(17969),i=t(70858),o=t(53707),s=t(14517),a=t(58173),c=i.url.join("wss://mt4-api.decodeex.com/","/"),l=(0,s.ZP)((function(e,n){return{response:[]}})),u=new o.Z(c,(function(e){var n=JSON.parse(e.data).map((function(e){return{symbol:e.s,contractSize:e.n,currency:e.c,digits:e.d,decimal:e.d}})),t=(0,a.keyBy)(n,"symbol");l.setState({response:n,KVResponse:t})}));n.Z=function(e){var n=(0,r.useRef)(!1),t=(0,r.useRef)([]),i=(0,r.useId)();(0,a.isNil)(e)||0===e.length?(n.current=!1,t.current=[]):n.current&&t.current===e||(n.current=!0,t.current=e,u.send_({c:"symbol",ls:e,r:i},!0))}},5524:function(e,n,t){t.d(n,{W:function(){return f}});var r=t(52398),i=(t(40208),t(2898)),o=(t(68846),t(1079),t(74482)),s=t(13827),a=t(25624),c=t(66296),l=t(52126),u=(t(99350),t(17969)),d=(t(8675),t(58173)),p=t(70289),f=function(e){var n,t=e.children,f=e.item,x=(0,u.useState)(null),h=(0,r.Z)(x,2),m=h[0],v=h[1],g=(0,i.Z)().t,Z=function(){v(null)},b=Boolean(m),y=[{label:"S/L",value:(0,d.isNil)((0,d.get)(f,"stopLossing"))?"-":(0,l.DU)((0,d.get)(f,"stopLossing"))},{label:g("swap"),value:(0,d.isNil)((0,d.get)(f,"swap"))?"-":(0,l.DU)((0,d.get)(f,"swap"))},{label:"T/P",value:(0,d.isNil)((0,d.get)(f,"takeProfit"))?"-":(0,l.DU)((0,d.get)(f,"takeProfit"))},{label:g("taxes"),value:(0,d.isNil)((0,d.get)(f,"taxes"))?"-":(0,l.DU)((0,d.get)(f,"taxes"))},{label:"ID",value:(0,d.get)(f,"ticket")},{label:g("charges"),value:(0,d.isNil)((0,d.get)(f,"charges"))?"-":(0,l.DU)((0,d.get)(f,"charges"))},"1970-01-01T00:00:00.000Z"===(null===f||void 0===f||null===(n=f.rawData)||void 0===n?void 0:n.closeTime)?{}:{label:g("tradeCloseTime"),value:(0,l.o0)((0,d.get)(f,"rawData.closeTime"))}];return(0,p.jsxs)(o.Z,{onMouseEnter:function(e){v(e.currentTarget)},onMouseLeave:Z,children:[t,(0,p.jsx)(s.ZP,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:b,anchorEl:m,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:Z,disableRestoreFocus:!0,children:(0,p.jsxs)(o.Z,{px:3,py:2,sx:{width:400},children:[(0,p.jsx)(a.Z,{sx:{fontSize:12,mb:1},children:(0,d.isNil)((0,d.get)(f,"rawData.openTime"))?"-":(0,l.o0)((0,d.get)(f,"rawData.openTime"))}),(0,d.chunk)(y,2).map((function(e,n){return(0,p.jsx)(c.Z,{direction:"row",alignItems:"center",spacing:3,children:e.map((function(e,n){return(0,p.jsxs)(c.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",flex:1,children:[(0,p.jsx)(a.Z,{sx:{fontSize:12},children:(0,d.get)(e,"label")}),(0,p.jsx)(a.Z,{sx:{fontSize:12},children:(0,d.get)(e,"value")})]},n)}))},n)}))]})})]})}},61568:function(e,n,t){t.d(n,{Z:function(){return ie}});var r=t(84691),i=t(99932),o=t(78450),s=t(75782),a=t(52398),c=t(40208),l=t(2898),u=t(68846),d=t(1079),p=t(25624),f=t(66296),x=t(74482),h=t(13827),m=t(80809),v=t(52126),g=t(99350),Z=t(17969),b=t(8675),y=t(58173),w=t(5524),j=t(31054),k=t(3641),S=t(84618),C=t(66601),P=t(85692),D=t(35018),T=t(72667),N=t(69580),L=t(25311),W=t(56039),A=t(42049),I=t(1532),z=t(44946),O=t(47452),F=t(64868),H=t(80014),B=t(18238),M=t(77323),q=t(66313),R=t(26056),E=t(74593),_=t(53705),U=t(48675),V=t(50258),Q=t(66265),J=t(47431),K=t(53664),X=t(25832),$=t(70289),G=(0,B.Z)(M.Z)((function(e){e.theme;return{backgroundColor:"rgb(40,40,61)",borderRadius:"6px"}})),Y=function(e){var n,t=(0,l.Z)().t,r=(0,H.H)((function(e){return[e.updateOrderDetail,e.setUpdateOrderDetail]})),c=(0,a.Z)(r,2),d=c[0],f=c[1],h=(0,X.W)(),m=(0,Z.useState)(!1),v=(0,a.Z)(m,2),b=v[0],w=v[1],S=(0,Z.useState)(!1),P=(0,a.Z)(S,2),D=P[0],T=P[1],N=(0,Z.useState)(!1),L=(0,a.Z)(N,2),W=L[0],A=L[1],F=(0,Z.useState)(null),B=(0,a.Z)(F,2),Y=B[0],ee=B[1],ne=(0,Z.useState)(null),te=(0,a.Z)(ne,2),re=(te[0],te[1]),ie=(0,Z.useState)(!1),oe=(0,a.Z)(ie,2),se=oe[0],ae=oe[1],ce=(0,g.Ds)().enqueueSnackbar,le=(0,Z.useState)(0==(0,y.get)(d,"stopLossing")?"":(0,y.get)(d,"stopLossing")||""),ue=(0,a.Z)(le,2),de=ue[0],pe=ue[1],fe=(0,Z.useState)(0==(0,y.get)(d,"takeProfit")?"":(0,y.get)(d,"takeProfit")||""),xe=(0,a.Z)(fe,2),he=xe[0],me=xe[1],ve=(0,Z.useState)((0,y.get)(d,"lot")),ge=(0,a.Z)(ve,2),Ze=ge[0],be=ge[1],ye=(0,Z.useState)(!1),we=(0,a.Z)(ye,2),je=we[0],ke=we[1],Se=(0,Z.useState)(1),Ce=(0,a.Z)(Se,2),Pe=Ce[0],De=Ce[1],Te=(0,Z.useState)((0,y.get)(d,"startPrice")||0),Ne=(0,a.Z)(Te,2),Le=Ne[0],We=Ne[1],Ae=(0,u._pY)(),Ie=Ae.data,ze=Ae.isLoading,Oe=(0,y.find)(Ie,(function(e){return e.login===(0,y.get)(d,"login")})),Fe=(0,u.vk$)({category:(0,y.get)(d,"rawData.:category.id"),request:!0}),He=Fe.data,Be=Fe.isLoading,Me=(0,y.find)(He,(function(e){return e.symbol===(0,y.get)(d,"symbol")}));console.log("orderDetail",d,Me);var qe=(0,u.OhN)({accountId:(0,y.get)(Oe,"id")}),Re=qe.data,Ee=qe.mutate,_e=qe.isLoading,Ue=(0,Z.useRef)(),Ve=(0,Z.useRef)(),Qe=(0,Z.useRef)(),Je=[{label:t("bid"),value:"-/-",ref:Ve},{label:t("ask"),value:"-/-",ref:Qe}],Ke=(0,k.Z)(null===Re||void 0===Re?void 0:Re.login,null===Re||void 0===Re?void 0:Re.password,null===Re||void 0===Re?void 0:Re.groupType);(0,Z.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),T(!1),e.next=5,Ke.login();case 5:w(!1),T(!0),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),"incorrectPassword"===e.t0.message&&ke(!0),w(!1),T(!1);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return null!==Re&&void 0!==Re&&Re.login&&!_e&&(Re.hasPassword?e():ke(!0)),function(){T(!1)}}),[null===Re||void 0===Re?void 0:Re.login,_e,(0,y.get)(Me,"symbol"),Pe]),(0,Z.useEffect)((function(){if(D&&Qe.current&&Ve.current){(0,y.isFunction)(Ue.current)&&Ue.current();Ue.current=null===Ke||void 0===Ke?void 0:Ke.watch((0,y.get)(Me,"symbol"),(e=Qe.current,n=Ve.current,function(t){null!==n&&void 0!==n&&n.innerHTML&&(n.innerHTML=(0,j.currencyFormatorWithDecimal)(t.quote.bid,"",(0,y.get)(Me,"decimal"),!0)),null!==e&&void 0!==e&&e.innerHTML&&(e.innerHTML=(0,j.currencyFormatorWithDecimal)(t.quote.ask,"",(0,y.get)(Me,"decimal"),!0))}))}var e,n;return function(){null===Ke||void 0===Ke||Ke.unwatch((0,y.get)(Me,"symbol")),(0,y.isFunction)(Ue.current)&&Ue.current()}}),[D,Ve.current,Qe.current]);var Xe=[{label:t("Buy limit"),value:"BuyLimit"},{label:t("Sell limit"),value:"SellLimit"},{label:t("Buy stop"),value:"BuyStop"},{label:t("Sell stop"),value:"SellStop"}],$e=ze||_e||Be,Ge=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,re(null),ae(!0),e.next=5,n();case 5:e.next=15;break;case 7:if(e.prev=7,e.t0=e.catch(0),console.log(e.t0),"incorrectPassword"!==e.t0.message){e.next=14;break}ke(!0),e.next=15;break;case 14:throw e.t0;case 15:return e.prev=15,ae(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,7,15,18]])})));return function(n){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={BuyLimit:k.M.BuyLimit,SellLimit:k.M.SellLimit,BuyStop:k.M.BuyStop,SellStop:k.M.SellStop},e.next=3,Ge((0,o.Z)((0,i.Z)().mark((function e(){var r,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=W&&Y?Math.floor(Y.getTime()/1e3):null,(o=n[(0,y.get)(d,"type")])!==k.M.BuyLimit&&o!==k.M.BuyStop){e.next=8;break}if(!(he&&Number(he)<Number(Le))){e.next=6;break}throw new Error("takeProfitLowerThanPrice");case 6:if(!(de&&Number(de)>Number(Le))){e.next=8;break}throw new Error("stopLossHigherThanPrice");case 8:if(o!==k.M.SellLimit&&o!==k.M.SellStop){e.next=13;break}if(!(he&&Number(he)>Number(Le))){e.next=11;break}throw new Error("takeProfitHigherThanPrice");case 11:if(!(de&&Number(de)<Number(Le))){e.next=13;break}throw new Error("stopLossLowerThanPrice");case 13:return console.log("send"),e.next=16,Ke.modify(Me.symbol,(0,y.get)(d,"ticket"),Number(Le),de?Number(de):null,he?Number(he):null,r);case 16:f((0,s.Z)((0,s.Z)({},d),{},{startPrice:Number(Le),stopLossing:Number(de),takeProfit:Number(he)})),ce(t("updateSuccess"),{variant:"success"}),setTimeout((function(){h(/balanceHook/)}),400),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0),ce(t("updateFailed",{reason:t(e.t0.message)}),{variant:"error"});case 25:case"end":return e.stop()}}),e,null,[[0,21]])}))));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),en=!D||W&&!(0,K.Z)(Y)||Le==(0,y.get)(d,"startPrice")&&de==(0,y.get)(d,"stopLossing")&&he==(0,y.get)(d,"takeProfit");return(0,$.jsxs)(x.Z,{sx:{px:3,pb:3,pt:3},children:[$e?(0,$.jsx)(M.Z,{sx:{height:"200px"},alignItems:"center",justifyContent:"center",children:(0,$.jsx)(I.Z,{})}):(0,$.jsxs)(M.Z,{flex:1,spacing:1,children:[(0,$.jsx)(M.Z,{alignItems:"center",justifyContent:"center",direction:"row",sx:{position:"relative",width:"100%"},children:Me&&(0,$.jsx)(E.Z,{item:Me,borderColor:"#3C3C50"})}),(0,$.jsxs)(G,{sx:{p:0},children:[(0,$.jsx)(R.nq,{title:t("accounts"),sx:{p:2,py:1},children:"FX ".concat(Oe.login)}),Oe&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(z.Z,{}),(0,$.jsxs)(M.Z,{sx:{p:2,py:1},children:[(0,$.jsxs)(M.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,$.jsx)(M.Z,{sx:{borderRadius:"100%",overflow:"hidden"},children:(0,$.jsx)(q.Z,{size:20,country:(0,y.get)(Oe,"country")})}),(0,$.jsx)(p.Z,{children:(0,y.get)(Oe,"currency")})]}),Oe.list&&(0,$.jsx)(M.Z,{sx:{mt:1},children:(0,$.jsx)(R.gp,{selectedAccountDetail:Oe})})]})]})]}),(0,$.jsx)(G,{sx:{p:0},children:(0,$.jsx)(M.Z,{sx:{p:2,py:1},spacing:2,direction:"row",alignItems:"center",justifyContent:"space-between",children:Je.map((function(e,n){return(0,$.jsxs)(x.Z,{children:[(0,$.jsx)(p.Z,{sx:{color:"#B4B4C8"},children:e.label}),(0,$.jsx)(p.Z,{fontSize:"24px",fontWeight:"600",ref:e.ref,children:e.value})]},n)}))})}),(0,$.jsx)(G,{sx:{p:2,py:1},children:(0,$.jsx)(R.nq,{title:t("type"),children:t("pendingOrder")})}),(0,$.jsxs)(G,{children:[(0,$.jsxs)(x.Z,{sx:{p:2,py:1},children:[(0,$.jsx)(p.Z,{sx:{color:"#B4B4C8"},children:t("pendingOrderTrade")}),(0,$.jsx)(R.nq,{title:t("type"),children:null===(n=(0,y.find)(Xe,(function(e){return e.value==(0,y.get)(d,"type")})))||void 0===n?void 0:n.label})]}),(0,$.jsx)(z.Z,{}),(0,$.jsx)(R.nq,{sx:{p:2,py:1},title:t("atPrice"),children:(0,$.jsx)(_.Xi,{variant:"outlined",size:"small",type:"number",inputProps:{style:{textAlign:"right"}},value:Le,placeholder:t("notSet"),onChange:function(e){return We(e.target.value)},disabled:"open"!==(0,y.get)(d,"status")})})]}),(0,$.jsxs)(G,{children:[(0,$.jsx)(R.nq,{sx:{p:2,py:1,pt:1.5},title:t("lot"),children:(0,$.jsx)(R.fe,{variant:"outlined",size:"small",type:"number",inputProps:{style:{textAlign:"right"}},value:Ze,onChange:be,placeholder:t("notSet"),disabled:!0})}),(0,$.jsx)(z.Z,{}),(0,$.jsx)(R.nq,{sx:{p:2,py:1},title:t("stopLoss"),children:(0,$.jsx)(R.fe,{variant:"outlined",size:"small",type:"number",margin:"dense",inputProps:{style:{textAlign:"right"}},value:de,onChange:pe,placeholder:t("notSet")})}),(0,$.jsx)(z.Z,{}),(0,$.jsx)(R.nq,{sx:{p:2,py:1},title:t("takeProfit"),children:(0,$.jsx)(R.fe,{variant:"outlined",size:"small",type:"number",margin:"dense",inputProps:{style:{textAlign:"right"}},value:he,onChange:me,placeholder:t("notSet")})}),(0,$.jsx)(z.Z,{}),(0,$.jsx)(R.nq,{sx:{p:2,py:1},title:t("expiration"),children:(0,$.jsxs)(M.Z,{alignItems:"center",direction:"row",children:[(0,$.jsx)(O.Z,{checked:W,onChange:function(e){A(e.target.checked)}}),(0,$.jsx)(U._,{dateAdapter:Q.Z,children:(0,$.jsx)(V.x,{disabled:!W,value:Y,onChange:function(e){ee(e)},OpenPickerButtonProps:{sx:{p:0,mr:0}},renderInput:function(e){var n=e.inputRef,r=e.inputProps,i=e.InputProps;return(0,$.jsx)(_.Xi,{size:"small",ref:n,placeholder:t("notSet"),inputProps:(0,s.Z)((0,s.Z)({},r),{},{style:{textAlign:"right"}}),InputProps:(0,s.Z)((0,s.Z)({},i),{},{sx:{px:0}})})}})})]})})]}),(0,$.jsx)(M.Z,{sx:{py:1,width:"100%"},children:(0,$.jsx)(J.Z,{loadingIndicator:b?t("verifying"):null,variant:"contained",onClick:Ye,disabled:en,loading:se||b,sx:{flex:1,color:"#000"},children:t("update")})})]}),je&&(0,$.jsx)(C.Z,{open:je,onClose:function(){return ke(!1)},onSuccess:function(){Ee(),De(Pe+1)},forexAccountId:(0,y.get)(Oe,"login")})]})},ee=function(){var e=(0,H.H)((function(e){return[e.updateOrderDialogOpen,e.closeUpdateOrderDialog]})),n=(0,a.Z)(e,2),t=n[0],r=n[1];return(0,$.jsxs)(A.I,{fullWidth:!0,maxWidth:"xs",open:t,onClose:r,children:[t&&(0,$.jsx)(Y,{}),(0,$.jsx)(F.Z,{onClick:r,sx:{position:"absolute",left:12,top:14},children:(0,$.jsx)(m.Z,{})})]})},ne=(0,Z.memo)((function(e){var n=e.item,t=(0,Z.useRef)();return(0,Z.useEffect)((function(){var e=N.Q.subscribe((function(e){var r=e.response[n.symbol];if(r){var i=r.std;t.current&&i&&(t.current.innerHTML=(0,j.currencyFormatorWithDecimal)([0,2,4].includes(n.rawData.cmd)?i.bid:i.ask,"",r.decimal,!0))}}));return function(){e()}}),[n.symbol]),(0,$.jsx)(p.Z,{sx:{fontSize:"12px"},ref:t,children:(0,j.currencyFormatorWithDecimal)(n.currentPrice,"",n.decimal,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),te=(0,Z.memo)((function(e){var n=e.item,t=(0,Z.useRef)();return console.log(n),(0,Z.useEffect)((function(){var e=T.H.subscribe((function(e){e.response;var r=(0,y.find)(e.response,(function(e){return e.symbol===n.symbol}));r&&t.current&&(t.current.innerHTML=(0,j.currencyFormatorWithDecimal)(n.startPrice,"",r.decimal,!0))}));return function(){e()}}),[n.symbol]),(0,$.jsx)(p.Z,{sx:{fontSize:"12px"},ref:t,children:(0,j.currencyFormatorWithDecimal)(n.startPrice,"",n.decimal,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),re=(0,Z.memo)((function(e){var n=e.item,t=(0,Z.useRef)(),r=(0,D.F)().getStockColorValue;return(0,Z.useEffect)((function(){var e=N.Q.subscribe((function(e){var i=e.response,o=i[n.symbol];if(o){var s=o.std;if(s){var a,c=(0,L.$)(n.rawData,s.bid,s.ask,o.contractSize,o.currency,null===(a=n.rawData)||void 0===a?void 0:a.accountCurrency,i),l=(0,j.currencyFormatorWithDecimal)(c,"",2,!0);!(0,y.isNil)(l)&&t.current&&(t.current.innerHTML=l,t.current.style.color=r(c))}}}));return function(){e()}}),[n.symbol]),(0,$.jsx)(p.Z,{sx:{fontSize:"12px",fontWeight:700,color:r(n.profit)},ref:t,children:(0,j.currencyFormatorWithDecimal)(n.profit,"",2,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),ie=(0,Z.forwardRef)((function(e,n){var t=e.type,j=e.autoHeight,T=void 0!==j&&j,N=e.login,L=e.home,A=void 0!==L&&L,I=e.hidePagination,z=void 0===I||I,O=e.closeAll,F=void 0!==O&&O,B=e.setCloseAll,M=void 0===B?function(){}:B,q=e.forexAccountId,R=e.setDisabled,E=void 0===R?function(){}:R,_=(0,l.Z)().t,U=(0,g.Ds)().enqueueSnackbar,V=(0,Z.useState)(!1),Q=(0,a.Z)(V,2),J=Q[0],K=Q[1],X=(0,Z.useState)(null),G=(0,a.Z)(X,2),Y=G[0],ie=G[1],oe=(0,Z.useState)(N),se=(0,a.Z)(oe,2),ae=se[0],ce=se[1],le=(0,Z.useState)(null),ue=(0,a.Z)(le,2),de=ue[0],pe=ue[1],fe=(0,Z.useState)(!1),xe=(0,a.Z)(fe,2),he=xe[0],me=xe[1],ve=(0,Z.useState)(!1),ge=(0,a.Z)(ve,2),Ze=ge[0],be=ge[1],ye=(0,Z.useState)({}),we=(0,a.Z)(ye,2),je=we[0],ke=we[1],Se=((0,P.Z)().user,(0,D.F)().getStockColorValue,(0,H.H)((function(e){return[e.setUpdateOrderDialogOpen,e.setUpdateOrderDetail]}))),Ce=(0,a.Z)(Se,2),Pe=(Ce[0],Ce[1],(0,u.mxK)((0,s.Z)({type:t,login:N},A&&"closed"===t?{startDate:(0,v.xA)(new Date((new Date).getTime()-5184e5).toISOString()),endDate:(0,v.xA)((new Date).toISOString())}:{}))),De=Pe.data,Te=Pe.mutate,Ne=Pe.isValidating,Le=function(){setTimeout((function(){Te()}),800)},We=(0,u.OhN)({accountId:de||q}).data;(0,W.b)("closed"===t?null:(0,y.uniq)(De.map((function(e){return e.symbol})))),(0,Z.useEffect)((function(){F&&be(!0)}),[F]),(0,Z.useEffect)((function(){console.log(De),De.length>0?E(!1):E(!0)}),[Ne]);var Ae=(0,k.Z)(null===We||void 0===We?void 0:We.login,null===We||void 0===We?void 0:We.password,null===We||void 0===We?void 0:We.groupType),Ie=function(){ie(null)};(0,Z.useImperativeHandle)(n,(function(){return{resetValue:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),firstTrade:null===De||void 0===De?void 0:De[0]}}),[n]);var ze=Boolean(Y),Oe=ze?"simple-popover":void 0,Fe=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),e.prev=1,e.next=4,(0,u.Hq6)(n);case 4:return e.next=6,Le();case 6:U(_("updateSuccess"),{variant:"success"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),U("".concat(_("updateFailed"),": ").concat(JSON.parse(e.t0.message).error.message),{variant:"error"});case 13:K(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}(),He=[{headerName:_("login"),field:"login",flex:1,minWidth:80,renderCell:function(e){var n=e.row,t="copyTrade"===(0,y.get)(n,"accountType")?"#4BA3E3":"live"===(0,y.get)(n,"accountType")?"#56B583":"signal"===(0,y.get)(n,"accountType")?"#FFB400":"demo"===(0,y.get)(n,"accountType")?"#ffffff":"#ea580c";return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(p.Z,{sx:{fontSize:"12px",color:t},children:(0,y.get)(n,"rawData.login")})})}},{headerName:_("lot"),field:"lot",flex:.5,minWidth:60,renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(p.Z,{sx:{fontSize:"12px"},children:(0,v.DU)(n.lot)})})}},{headerName:_("symbol"),field:"symbol",flex:.5,minWidth:75,renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(p.Z,{sx:{fontSize:"12px"},children:(0,y.get)(n,"displaySymbol")})})}},{headerName:_("type"),field:"type",flex:.5,minWidth:60,renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(p.Z,{sx:{fontSize:"12px"},children:(0,y.get)(n,"orderCommand")})})}},{headerName:_("open"===t?"forexPendingOpenPrice":"forexOpenPrice"),field:"openPrice",minWidth:110,flex:1,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(te,{item:n})})}},{headerName:_("closed"===t?"forexClosedClosePrice":"forexNormalClosePrice"),field:"closePrice",minWidth:110,flex:1,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(ne,{item:n})})}},{headerName:_("tradeCloseTime"),field:"closeTime",flex:1,minWidth:130,hide:"closed"!==t,renderCell:function(e){var n=e.row;return(0,$.jsxs)(w.W,{item:n,children:[(0,$.jsx)(p.Z,{sx:{fontSize:"12px",textOverflow:"ellipsis",overflow:"hidden",width:"100%"},children:(0,v.o0)(n.rawData.closeTime)})," "]})}}].concat((0,r.Z)("open"===t?[]:[{headerName:_("profit"),field:"profit",flex:1,minWidth:100,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,$.jsx)(w.W,{item:n,children:(0,$.jsx)(re,{item:n})})}}]),[{headerName:_("actions"),field:"action",flex:1,minWidth:120,hide:"closed"===t,renderCell:function(e){var n=e.row;return"copyTrade"===n.accountType?null:(0,$.jsx)(f.Z,{direction:"row",spacing:1,children:"closed"!==t&&"copying"!==t&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center"},onClick:function(e){ke(n),ce(n.login),pe(n.rawData.accountId),n.hasPassword?(be(!0),ce(n.rawData.accountId)):(ce(n.rawData.accountId),me(!0))},children:[(0,$.jsx)(x.Z,{sx:{backgroundColor:"primary.rise",height:15,width:15,borderRadius:"50%",display:"flex",alignItems:"center",justifyItems:"center",textAlign:"center"},children:"positions"!==t?(0,$.jsx)(m.Z,{sx:{color:"#fff",fontSize:"14px"}}):(0,$.jsx)("img",{src:"/assets/icons/shut-down-line.svg",style:{width:"12px",position:"relative",left:"1px"}})}),(0,$.jsx)(p.Z,{sx:{fontSize:"12px",color:"primary.rise",ml:1},children:_("positions"===t?"positionClose":"cancel")})]}),(0,$.jsx)(h.ZP,{id:Oe,open:ze&je.ticket===n.ticket,anchorEl:Y,onClose:Ie,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,$.jsxs)(x.Z,{sx:{width:200,textAlign:"center",py:1},children:[(0,$.jsx)(p.Z,{sx:{mb:1},children:_("positions"===t?"whetherToClose":"cancelPending")}),(0,$.jsxs)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center",mr:1},onClick:Ie,children:[(0,$.jsx)(m.Z,{fontSize:"18px",sx:{color:"#fff"}}),_("cancel")]}),(0,$.jsx)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center"},onClick:(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n.rawData.hasPassword){e.next=5;break}Ie(),me(!0),e.next=8;break;case 5:return Ie(),e.next=8,Fe({ticket:n.ticket,type:"positions"===t?"positions":"open",login:n.login});case 8:case"end":return e.stop()}}),e)}))),children:_("confirm")})]})})]})})}}]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(x.Z,{sx:{"& .style-header":{fontSize:14,backgroundColor:"#3C3C50",height:36,fontWeight:"bold"},"& .MuiDataGrid-columnHeaders":{borderRadius:0},height:"100%"},children:[(0,$.jsx)(c.Z,{columns:He,rows:De,headerClassName:"style-header",cellClassName:"style-cell",hideFooter:!0,hidePagination:z,autoHeight:T}),(0,$.jsx)(S.Z,{open:Ze,onClose:function(){be(!1),M(!1)},onResetPassword:function(){return me(!0)},accountLogin:null===We||void 0===We?void 0:We.login,password:null===We||void 0===We?void 0:We.password,groupType:null===We||void 0===We?void 0:We.groupType,type:t,ticket:je.ticket,clientApi:Ae,mutate:Le,closeAll:F}),(0,$.jsx)(C.Z,{open:he,onClose:function(){return me(!1)},forexAccountId:ae,onSuccess:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("---------------------"),"positions"!==t){e.next=13;break}if(F){e.next=9;break}return e.next=5,null===n||void 0===n?void 0:n.closePosition(null===je||void 0===je?void 0:je.ticket);case 5:r=e.sent,console.log(r),e.next=11;break;case 9:return e.next=11,null===n||void 0===n?void 0:n.closeAll();case 11:case 16:e.next=20;break;case 13:if(F){e.next=18;break}return e.next=16,null===n||void 0===n?void 0:n.cancelOrder(null===je||void 0===je?void 0:je.ticket);case 18:return e.next=20,null===n||void 0===n?void 0:n.cancelAll();case 20:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),(0,$.jsx)(ee,{})]}),(0,$.jsx)(b.Z,{loading:J})]})}))},25311:function(e,n,t){t.d(n,{$:function(){return o}});var r=t(58173),i=function(e,n,t,i,o,s){var a=t+n,c=i[a],l=(0,r.get)(c,"std");return null!=c&&l?(0===o?e/l.bid:e/l.ask).toFixed(2):(c=i[a=n+t],l=(0,r.get)(c,"std"),null!=c&&l?(0===o?e*l.bid:e*l.ask).toFixed(2):null)},o=function(e,n,t,r,o,s,a){var c=e.cmd,l=e.volume,u=e.openPrice,d=(e.accountGroupType,l/100*r),p=0;if(p=0===c?((n-u)*d).toFixed(2):((u-t)*d).toFixed(2),o!==s){var f=i(p,o,s,a,c);return null!=f?f:null==(f=i(p,o,"USD",a,c))||null==(f=i(f,"USD",s,a,c))?0:f}return p}}}]);