"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[2082],{64965:function(e,n,r){r(31530);var t=r(47006),s=r(27203),i=r(98845);n.Z=function(e){var n=e.loading;return(0,i.jsx)(t.Z,{sx:{zIndex:"9999999"},open:n,children:(0,i.jsx)(s.Z,{})})}},2082:function(e,n,r){r.r(n),r.d(n,{default:function(){return E}});var t=r(92680),s=r(24190),i=r(2211),a=r(12130),o=r(31530),c=r(26521),l=r(24786),u=r(36326),d=r(11836),f=r(28418),x=r(81521),m=(r(93850),r(67350),r(32112)),p=r(88658),h=r(64505),Z=r(45927),v=(r(69401),r(29367)),w=r(64965),b=(r(43248),r(76956)),j=r(52546),g=r(9763),y=(r(93001),r(26554)),k=r(17646),S=r(33649),C=r(96115),N=r.n(C),P=r(40838),z=r(39702),I=r(83960),V=r(98845),T=["values","setValue","name","errors","disabled","verifyStatusName","verifyType","sx"],A=function(e){var n=e.values,r=e.setValue,u=e.name,d=(e.errors,e.disabled),x=e.verifyStatusName,v=e.verifyType,w=e.sx,C=(0,b.Z)(e,T),A=(0,p.Z)(),E=A.t,q=A.currentLang,F=(0,o.useState)(null),M=(0,a.Z)(F,2),D=M[0],U=M[1],W=(0,o.useState)(""),_=(0,a.Z)(W,2),X=_[0],B=_[1],L=(0,o.useState)(null),R=(0,a.Z)(L,2),$=R[0],J=R[1],G=(0,o.useState)(!1),H=(0,a.Z)(G,2),K=H[0],O=H[1],Q=(0,o.useState)(!1),Y=(0,a.Z)(Q,2),ee=Y[0],ne=Y[1];(0,o.useEffect)((function(){null===n[u]&&r((function(e){return e[u]="",(0,i.Z)({},e)}))}),[n[u]]);var re=(0,f.Ds)().enqueueSnackbar,te=(0,P.Z)(12e4,1e3),se=(0,a.Z)(te,2),ie=se[0],ae=se[1],oe=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){var r,s;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,S.default)(n[u],"any",{strictMode:!0})&&!N()(n[u],{strictMode:!0})){e.next=10;break}return e.next=3,(0,Z.$X)({method:"mobile",locale:q.backendValue,mobile:n[u],verifyType:v});case 3:r=e.sent,s=r.issued,re(E("TFASend"),{variant:"success"}),U(s),ae.start(12e4),e.next=11;break;case 10:re(E("mobileNumberfailText"),{variant:"error"});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O(!0),J(null),e.next=5,(0,Z.dh)({mobile:n[u],code:X,issueId:D,verifyId:n.processedUser.id,verifyType:v});case 5:r((function(e){return e[x]=!0,(0,i.Z)({},e)})),re(E("verifySuccess"),{variant:"success"}),U(null),ne(!1),e.next=17;break;case 11:throw e.prev=11,e.t0=e.catch(0),r((function(e){return e[x]=!1,(0,i.Z)({},e)})),J((0,I.getErrorMessage)(e.t0)),re(E("verifyFailed"),{variant:"error"}),e.t0;case 17:return e.prev=17,O(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,11,17,20]])})));return function(){return e.apply(this,arguments)}}(),le=""===X||(0,z.isNil)(D),ue=Boolean(n[x]);return(0,V.jsxs)(c.Z,{sx:(0,i.Z)({my:2},w),children:[(0,V.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(m.XI,(0,i.Z)({field:u,disabled:(d||ue)&&!ee},C)),!ue||ee?(0,V.jsx)(h.C5,{onClick:oe,disabled:d||ie>0,sx:{height:54,width:100,ml:1},children:ie<=0?E("send"):ie/1e3+"s"}):(0,V.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(y.Z,{color:"success",sx:{width:50},fontSize:"small"}),(0,V.jsx)(j.Z,{disabled:d,onClick:function(){return ne(!0)},children:(0,V.jsx)(k.Z,{sx:{width:20}})})]})]}),null!==D&&(0,V.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",mt:1},children:[(0,V.jsx)(g.Z,{value:X,onChange:function(e){return B(e.target.value)},placeholder:"TFA",disabled:d}),(0,V.jsx)(h.sq,{loading:K,disabled:le||d,onClick:ce,sx:{width:100,height:54,ml:1},children:E("verify")}),$&&(0,V.jsx)(l.Z,{color:"error",sx:{width:"100%"},children:E($)})]})]})};r(9166);function E(){var e=(0,p.Z)().t,n=(0,f.Ds)().enqueueSnackbar,r=(0,o.useState)({}),b=(0,a.Z)(r,2),j=(b[0],b[1],(0,o.useState)({})),g=(0,a.Z)(j,2),y=g[0],k=g[1],S=(0,o.useState)(!1),C=(0,a.Z)(S,2),N=C[0],P=C[1],I=(0,Z.zm)(),T=I.updateProfile,E=I.data,q=(0,Z.Un)().mutate,F=(0,o.useState)((0,i.Z)((0,i.Z)((0,i.Z)({},E),E[":preference"]),{},{oldPassword:""})),M=(0,a.Z)(F,2),D=M[0],U=M[1],W=(0,o.useState)({mobile:!1,email:!1}),_=(0,a.Z)(W,2),X=_[0],B=_[1],L=(0,o.useState)((function(){return{appNotification:Boolean((0,z.get)(E,":preference.appNotification")),smsNotification:Boolean((0,z.get)(E,":preference.smsNotification")),emailNotification:Boolean((0,z.get)(E,":preference.emailNotification"))}})),R=(0,a.Z)(L,2),$=R[0],J=R[1];(0,o.useEffect)((function(){U((0,i.Z)((0,i.Z)((0,i.Z)({},E),E[":preference"]),{},{oldPassword:""}));var e=E.isMobileVerified,n=E.isEmailVerified;B((function(r){return e?(r.mobile=!0,r.email=!1,(0,i.Z)({},r)):n?(r.email=!0,r.mobile=!1,(0,i.Z)({},r)):(0,i.Z)({},r)}))}),[E]);var G=(0,Z.JA)();console.log(E);var H=[{label:e("ConstantEnglish"),value:"en-US"},{label:e("ConstantChinese"),value:"zh-CN"},{label:e("TraditionalChinese"),value:"zh-TW"}],K=[{label:e("greenUpRedDown"),value:"greenUpRedDown"},{label:e("greenDownRedUp"),value:"greenDownRedUp"}],O=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,T(E.id,{avatar:D.avatar,surname:D.surname,firstName:D.firstName,name:D.name});case 3:n(e("updateSuccess"),{variant:"success"}),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),n(e(r.t0.message),{variant:"error"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})));return function(){return r.apply(this,arguments)}}();(0,o.useEffect)((function(){U((function(e){return e.avatar=E.avatar,(0,i.Z)({},e)}))}),[]);var Q=v.object().shape({confirmPassword:v.string().matches(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/,{message:e("password format")}).required(e("password format")).min(8,e("password format")).max(30,e("password format")),newPassword:v.string().matches(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/,{message:e("password format")}).required(e("password format")).min(8,e("password format")).max(30,e("password format")),oldPassword:v.string().required(e("Invalid password."))}),Y=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,Z.F4)({oldPassword:D.oldPassword,password:D.newPassword});case 4:n(e("updateSuccess"),{variant:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 10:P(!1);case 11:case"end":return r.stop()}}),r,null,[[1,7]])})));return function(){return r.apply(this,arguments)}}(),ee=function(){var n=(0,s.Z)((0,t.Z)().mark((function n(){return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:Q.validate({oldPassword:D.oldPassword,newPassword:D.newPassword,confirmPassword:D.confirmPassword}).then((function(n){D.newPassword===D.confirmPassword?(k({}),Y()):k((function(n){return n.confirmPassword=e("differentPassword"),(0,i.Z)({},n)}))})).catch((function(e){k({}),k((function(n){return n[e.path]=e.message,(0,i.Z)({},n)}))}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ne=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,Z.xj)(D.id,{locale:D.locale,stockColor:D.stockColor});case 4:q(),n(e("updateSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 11:P(!1);case 12:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(){return r.apply(this,arguments)}}(),re=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,Z.xj)(D.id,(0,i.Z)({notificationLocale:D.notificationLocale},$));case 4:q(),n(e("updateSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 11:P(!1);case 12:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(){return r.apply(this,arguments)}}(),te=(0,o.useCallback)(function(){var r=(0,s.Z)((0,t.Z)().mark((function r(s){var a;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,G(s[0]);case 3:a=r.sent,U((function(e){return e.avatar=a,(0,i.Z)({},e)})),n(e("uploadSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),n(e("uploadField"),{variant:"error"});case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}(),[U]),se=function(e,n){var r=E.isMobileVerified,t=E.isEmailVerified;B(r&&t?function(r){return r[n]=e.target.checked,(0,i.Z)({},r)}:function(e){return r||t?"mobile"===n?r?(e.mobile=!0,e.email=!1,(0,i.Z)({},e)):(0,i.Z)({},e):"email"===n?t?(e.email=!0,e.mobile=!1,(0,i.Z)({},e)):(0,i.Z)({},e):void 0:(0,i.Z)({},e)})};return(0,V.jsxs)(c.Z,{sx:{width:{xs:"100%",md:800},mx:"auto"},children:[(0,V.jsx)(c.Z,{sx:{backgroundColor:"background.card",py:{xs:1,md:6},px:{xs:2,md:10},borderRadius:1,display:"flex",flexDirection:"column",mt:2},children:(0,V.jsxs)(m.dz,{values:D,setValues:U,errors:y,children:[(0,V.jsxs)(c.Z,{children:[(0,V.jsx)(l.Z,{variant:"h5",children:e("userProfile")}),(0,V.jsx)(m.i_,{field:"avatar",onDrop:te,accept:"image/*",maxSize:3145728}),"company"===(null===E||void 0===E?void 0:E.type)?(0,V.jsx)(m.XI,{field:"name",label:e("fullCompanyName"),sx:{my:1}}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(m.XI,{field:"firstName",label:e("firstName"),sx:{my:1}}),(0,V.jsx)(m.XI,{field:"surname",label:e("surname"),sx:{my:1}})]}),(0,V.jsx)(c.Z,{sx:{textAlign:"right",my:2},children:(0,V.jsx)(h.C5,{sx:{px:5},onClick:O,children:e("submit")})})]}),(0,V.jsxs)(c.Z,{children:[(0,V.jsx)(l.Z,{variant:"h5",children:e("security")}),(0,V.jsx)(l.Z,{variant:"h6",sx:{fontSize:"13px !important",mt:2,mb:1},children:e("changePassword")}),(0,V.jsx)(m.Wz,{label:e("oldPassword"),field:"oldPassword",sx:{mt:2}}),(0,V.jsx)(m.Wz,{label:e("newPassword"),field:"newPassword",sx:{mt:2}}),(0,V.jsx)(m.Wz,{label:e("confirmPassword"),field:"confirmPassword",sx:{mt:2}}),(0,V.jsx)(c.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:ee,children:e("submit")})}),(0,V.jsx)(l.Z,{variant:"h6",sx:{fontSize:"13px !important",my:2},children:e("twoFactor")}),(0,V.jsxs)(c.Z,{children:[(0,V.jsxs)(c.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("email")}),(0,V.jsx)(u.Z,{checked:null===X||void 0===X?void 0:X.email,onChange:function(e){return se(e,"email")}})]}),(null===X||void 0===X?void 0:X.email)&&(0,V.jsx)(A,{name:"email",values:D,verifyStatusName:"isEmailVerified",setValue:U,verifyType:"profile",disabled:!0})]}),(0,V.jsxs)(c.Z,{children:[(0,V.jsxs)(c.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(l.Z,{sx:{mr:1},children:e("mobile")})," ",(0,V.jsx)(d.Z,{title:e("useEmailVerify"),sx:{ml:2},children:(0,V.jsx)(x.Z,{sx:{fontSize:"18px"}})})]}),(0,V.jsx)(u.Z,{checked:null===X||void 0===X?void 0:X.mobile,onChange:function(e){return se(e,"mobile")}})]}),(null===X||void 0===X?void 0:X.mobile)&&(0,V.jsx)(A,{name:"mobile",values:D,verifyStatusName:"isMobileVerified",setValue:U,verifyType:"profile",disabled:!0})]})]}),(0,V.jsxs)(c.Z,{sx:{mt:3},children:[(0,V.jsx)(l.Z,{variant:"h6",children:e("preference")}),(0,V.jsx)(m.Nz,{options:H,sx:{width:"100%",mt:2},size:"medium",field:"locale"}),(0,V.jsx)(m.Nz,{options:K,sx:{width:"100%",mt:2},size:"medium",field:"stockColor"}),(0,V.jsx)(c.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:ne,children:e("submit")})})]}),(0,V.jsxs)(c.Z,{sx:{mt:3},children:[(0,V.jsx)(l.Z,{variant:"h6",children:e("notificationSettings")}),(0,V.jsxs)(c.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("appNotification")}),(0,V.jsx)(u.Z,{checked:null===$||void 0===$?void 0:$.appNotification,onChange:function(e){return J((function(e){return(0,i.Z)((0,i.Z)({},e),{},{appNotification:!e.appNotification})}))}})]}),(0,V.jsxs)(c.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("smsNotification")}),(0,V.jsx)(u.Z,{checked:null===$||void 0===$?void 0:$.smsNotification,onChange:function(e){return J((function(e){return(0,i.Z)((0,i.Z)({},e),{},{smsNotification:!e.smsNotification})}))},disabled:!(0,z.get)(E,"isMobileVerified")})]}),(0,V.jsxs)(c.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("emailNotification")}),(0,V.jsx)(u.Z,{checked:null===$||void 0===$?void 0:$.emailNotification,onChange:function(e){return J((function(e){return(0,i.Z)((0,i.Z)({},e),{},{emailNotification:!e.emailNotification})}))},disabled:!(0,z.get)(E,"isEmailVerified")})]}),(0,V.jsx)(m.Nz,{options:H,sx:{width:"100%",mt:2},size:"medium",field:"notificationLocale"}),(0,V.jsx)(c.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:re,children:e("submit")})})]})]})}),(0,V.jsx)(w.Z,{loading:N})]})}},9166:function(e,n,r){var t=r(2211),s=r(92680),i=r(24190),a=r(12130),o=r(76956),c=r(26521),l=r(9763),u=r(24786),d=r(31530),f=r(93001),x=r(64505),m=r(26554),p=r(88658),h=r(33649),Z=r(96115),v=r.n(Z),w=r(40838),b=r(39702),j=r(28418),g=r(45927),y=r(83960),k=r(98845),S=["values","setValue","name","errors","disabled","verifyStatusName","sx"],C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(null===e||void 0===e?void 0:e.startsWith("+86"))&&14===e.length};n.Z=function(e){var n=e.values,r=e.setValue,Z=e.name,N=(e.errors,e.disabled),P=e.verifyStatusName,z=e.sx,I=(0,o.Z)(e,S),V=(0,p.Z)(),T=V.t,A=V.currentLang,E=(0,d.useState)(null),q=(0,a.Z)(E,2),F=q[0],M=q[1],D=(0,d.useState)(""),U=(0,a.Z)(D,2),W=U[0],_=U[1],X=(0,d.useState)(null),B=(0,a.Z)(X,2),L=B[0],R=B[1],$=(0,d.useState)(!1),J=(0,a.Z)($,2),G=J[0],H=J[1];(0,d.useEffect)((function(){null===n[Z]&&r(Z,"")}),[n[Z]]);var K=(0,j.Ds)().enqueueSnackbar,O=(0,w.Z)(12e4,1e3),Q=(0,a.Z)(O,2),Y=Q[0],ee=Q[1],ne=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){var r,t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,h.default)(n[Z],"any",{strictMode:!0})&&!v()(n[Z],{strictMode:!0})){e.next=10;break}return e.next=3,(0,g.$X)({method:"mobile",locale:A.backendValue,mobile:n[Z]});case 3:r=e.sent,t=r.issued,K(T("TFASend"),{variant:"success"}),M(t),ee.start(12e4),e.next=11;break;case 10:K(T("mobileNumberfailText"),{variant:"error"});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,H(!0),R(null),e.next=5,(0,g.dh)({mobile:n[Z],code:W,issueId:F,verifyId:n.verifyId});case 5:r(P,!0),K(T("verifySuccess"),{variant:"success"}),e.next=15;break;case 9:throw e.prev=9,e.t0=e.catch(0),r(P,!1),R((0,y.getErrorMessage)(e.t0)),K(T("verifyFailed"),{variant:"error"}),e.t0;case 15:return e.prev=15,H(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,9,15,18]])})));return function(){return e.apply(this,arguments)}}(),te=""===W||(0,b.isNil)(F),se=Boolean(n[P]);return(0,k.jsxs)(c.Z,{sx:(0,t.Z)({my:2},z),children:[(0,k.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(f.au,(0,t.Z)({name:Z,disabled:N||se},I)),se?(0,k.jsx)(m.Z,{color:"success",sx:{width:50},fontSize:"small"}):(0,k.jsx)(x.C5,{onClick:ne,disabled:N||Y>0||C(n[Z]),sx:{height:54,width:100,ml:1},children:Y<=0?T("send"):Y/1e3+"s"})]}),null!==F&&!se&&(0,k.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,k.jsx)(l.Z,{value:W,onChange:function(e){return _(e.target.value)},placeholder:"TFA",disabled:N}),(0,k.jsx)(x.sq,{loading:G,disabled:te||se||N,onClick:re,sx:{width:100,height:54,ml:1},children:T("verify")}),L&&(0,k.jsx)(u.Z,{color:"error",sx:{width:"100%"},children:T(L)})]})]})}}}]);