"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[2822],{87749:function(e,n,t){var r=t(2211),s=t(92680),o=t(24190),c=t(12130),u=t(27203),i=t(24786),a=t(26521),l=t(42924),f=t(7223),d=t(34481),p=t(1974),h=t(64505),w=t(88658),v=t(31530),k=t(14674),Z=t(30298),x=t(91874),g=t(18858),S=t(98845),b=function(e){var n=e.onSuccess,t=e.forexAccountId,r=e.onClose,l=(0,w.Z)().t,f=(0,v.useState)({password:""}),d=(0,c.Z)(f,2),b=d[0],y=d[1],m=(0,v.useState)(null),O=(0,c.Z)(m,2),C=O[0],R=O[1],_=(0,v.useState)(!1),E=(0,c.Z)(_,2),j=E[0],q=E[1],N=(0,Z.Oh)({accountId:t}),I=N.data,D=(N.mutate,N.isLoading),L=(0,k.Z)(null===I||void 0===I?void 0:I.login,null===b||void 0===b?void 0:b.password,null===I||void 0===I?void 0:I.groupType),P=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q(!0),e.next=4,null===L||void 0===L?void 0:L.login();case 4:return e.next=6,(0,Z.Rj)({accountId:null===I||void 0===I?void 0:I.id,password:null===b||void 0===b?void 0:b.password});case 6:r(),setTimeout((function(){y({password:""}),R(null),q(!1)}),200),n&&n(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),R(l((0,x.getErrorMessage)(e.t0)));case 13:return e.prev=13,q(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(){return e.apply(this,arguments)}}();return D?(0,S.jsx)(p.Z,{sx:{py:2},direction:"row",alignItems:"center",justifyContent:"center",children:(0,S.jsx)(u.Z,{})}):(0,S.jsx)(p.Z,{spacing:2,sx:{width:"100%"},children:(0,S.jsxs)(p.Z,{spacing:2,children:[(0,S.jsx)(i.Z,{variant:"h5",children:l("requirePassword")}),(0,S.jsx)(i.Z,{variant:"body2",children:l("requirePasswordDesc",{login:null===I||void 0===I?void 0:I.login})}),(0,S.jsx)(g.dz,{values:b,setValues:y,children:(0,S.jsx)(g.xr,{field:"password",label:l("password"),sx:{my:1}})}),C&&(0,S.jsx)(a.Z,{children:(0,S.jsx)(i.Z,{textAlign:"center",color:"red",children:C})}),(0,S.jsx)(h.sq,{isLoading:j,onClick:P,children:l("confirm")})]})})};n.Z=function(e){var n=e.open,t=e.onClose,s=e.onSuccess,o=e.forexAccountId;return(0,S.jsx)(l.Z,{fullWidth:!0,maxWidth:"xs",open:n,onClose:t,PaperComponent:function(e){return(0,S.jsxs)(a.Z,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,S.jsx)(a.Z,{onClick:t,sx:{width:"100%",height:"100%",position:"fixed"}}),(0,S.jsx)(f.Z,(0,r.Z)((0,r.Z)({},e),{},{children:e.children}))]})},children:(0,S.jsx)(d.Z,{sx:{pb:5},children:(0,S.jsx)(b,{onSuccess:s,forexAccountId:o,onClose:t})})})}},14674:function(e,n,t){t.d(n,{M:function(){return v}});var r=t(92680),s=t(24190),o=t(16487),c=t(31530),u=t(68468),i=t(88851),a=t(82177),l=t(39702),f=u.url.join("wss://mt4-api.decodeex.com/","/"),d=(0,a.ZP)((function(e,n){return{request:{},setRequests:function(n){return e((function(){return{request:n}}))}}})),p=(0,a.ZP)((function(e,n){return{quote:{},historyQuotes:[],setQuote:function(n){return e((function(){return{quote:n}}))}}})),h=new i.Z(f,(function(e){var n,t=JSON.parse(e.data),r=t.e,s=t.c,c=t.l,u=t.s,i=t.b,a=t.a,l=t.t,f=t.tk,h=t.op;if((null===(n=d.getState().request)||void 0===n?void 0:n.login)===c){var v;if(r)return v=s===w.BAD_REQUEST?"badRequest":s===w.LOGIN_ERROR?"incorrectPassword":s===w.NOT_FOUND?"notFound":r||"serverError",void d.setState({request:{success:!1,result:null,error:v,login:null}});if(f)d.setState({request:{success:!0,result:null,error:null,login:null}});else if(u){var k={login:c,symbol:u,bid:i,ask:a,time:l};p.setState((function(){return{quote:k,historyQuotes:[].concat((0,o.Z)(p.getState().historyQuotes),[k])}}))}else{var Z;if(-3===h)return console.log("Login successfully"),void d.setState({request:{success:!0,result:null,error:null,login:null===(Z=d.getState().request)||void 0===Z?void 0:Z.login}});d.setState({request:{success:!0,result:null,error:null,login:null}}),console.warn("Received unknown ws message",t)}}})),w={BAD_REQUEST:400,NOT_FOUND:404,GENERAL_ERROR:500,LOGIN_ERROR:401},v={Buy:0,Sell:1,BuyLimit:2,SellLimit:3,BuyStop:4,SellStop:5};n.Z=function(e,n,t,o){var u="".concat(e,":").concat(encodeURIComponent(n));o&&(u+=":demo");var i=(0,c.useMemo)((function(){if((0,l.isNil)(n)||""==n)return null;var o=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d.setState({request:{success:!1,result:null,error:null,login:e}}),n.next=3,new Promise((function(e,n){var t=d.subscribe((function(r){var s=r.request;console.log("request",s),s.success&&(e(s),t()),s.error&&(n(new Error(s.error)),t())}));setTimeout((function(){t(),e(!0)}),8e3)}));case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return{login:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"login",t:u,g:t},!0),e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),watch:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n,s){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"sub",t:u,g:t,s:n},!0),e.abrupt("return",p.subscribe((function(e){s&&s(e)})));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),unwatch:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.send_({c:"unsub",t:u,g:t,s:n},!0);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),closePosition:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"close",t:u,g:t,tk:n},!0),e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),closeAll:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("close all"),h.send_({c:"close",t:u,g:t,tk:-1},!0),e.next=4,o();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),cancelOrder:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"cancel",t:u,g:t,tk:n},!0),e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),cancelAll:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"cancel",t:u,g:t,tk:-1},!0),e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),sendOrder:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n,s,c,i,a,l,f,d){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h.send_({c:"order",t:u,g:t,s:n,op:s,vl:c,p:i,sl:a,tp:l,e:d,m:f},!0),e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n,t,r,s,o,c,u,i){return e.apply(this,arguments)}}()}}),[t,u,n]);return i}},95434:function(e,n,t){t.d(n,{F:function(){return w}});var r=t(2211),s=t(92680),o=t(24190),c=t(76956),u=t(39702),i=t(73404),a=t(31530),l=t(15157),f=t(30298),d=["stockColor","syncVerifyStatusFromProfile"],p={greenUpRedDown:{up:"stockGreen",down:"stockRed"},greenDownRedUp:{up:"stockRed",down:"stockGreen"}},h={stockRed:"#f43f5e",stockGreen:"#34d399"},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.disableSyncService,t=void 0!==n&&n,w=(0,f.Un)(),v=w.data,k=w.isLoading,Z=(0,l.usePreferenceStore)((function(e){return e})),x=Z.stockColor,g=Z.syncVerifyStatusFromProfile,S=(0,c.Z)(Z,d),b=(0,i.pm)(),y=(0,a.useCallback)(function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(0,u.get)(v,"preference.id")){e.next=5;break}return e.next=4,(0,f.uf)({payload:n,preferenceId:(0,u.get)(v,"preference.id")});case 4:return e.abrupt("return",e.sent);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),b.show({description:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),[v]),m=(0,a.useRef)(0);(0,a.useEffect)((function(){t||0!==m.current||k||!v||(g(v),m.current+=1)}),[v,k]);var O=x||"greenUpRedDown",C=h[p[O].up],R=h[p[O].down];return(0,r.Z)((0,r.Z)({stockColor:O,stockUpColor:C,stockDownColor:R},S),{},{getStockColorValue:function(e){return e>0?C:e<0?R:"#78716c"},updatePreference:y,isLoading:k})}},88851:function(e,n,t){var r=t(92680),s=t(24190),o=t(7403),c=t(56141),u=t(68468),i=0,a=1,l=function(){function e(n,t){var r=this;(0,o.Z)(this,e),this.webSocketOnOpen=function(){console.log("[-- CONNECTION ESTABLISHED --]")},this.webSocketOnClose=function(){console.log("[-- CONNECTION CLOSED --]"),r.disconnect()},this.webSocketOnError=function(){console.log("[-- ERROR OCCURRED --]"),r.disconnect()},this.url=n,this.webSocketOnMessage=t}return(0,c.Z)(e,[{key:"connect_",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.webSocket){e.next=10;break}return this.webSocket=new WebSocket(this.url,["aspnetcore-ws.json"]),this.state=i,this.webSocket.onopen=this.webSocketOnOpen,this.webSocket.onclose=this.webSocketOnClose,this.webSocket.onerror=this.webSocketOnError,this.webSocket.onmessage=this.webSocketOnMessage,e.next=9,(0,u.waitUntil_)((function(){return null==n.webSocket||n.webSocket.readyState===a}),100,30);case 9:console.log("ready",this.webSocket.readyState);case 10:return e.abrupt("return",null!=this.webSocket&&this.webSocket.readyState===a);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){this.webSocket&&(this.webSocket.close(),delete this.webSocket)}},{key:"send_",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n,t){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect_();case 2:if(!e.sent){e.next=8;break}return s=JSON.stringify(n),this.webSocket.send(s),e.abrupt("return",!0);case 8:if(t){e.next=10;break}throw new Error("Cannot connect to server.");case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()}]),e}();n.Z=l}}]);