"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[4735],{7510:function(e,n,r){r(54127);var t=r(8556),s=r(29744),i=r(94664);n.Z=function(e){var n=e.loading;return(0,i.jsx)(t.Z,{sx:{zIndex:"9999999"},open:n,children:(0,i.jsx)(s.Z,{})})}},94735:function(e,n,r){r.r(n),r.d(n,{default:function(){return q}});var t=r(99932),s=r(78450),i=r(75782),a=r(52398),c=r(54127),o=r(72722),l=r(75625),u=r(62382),d=r(86649),f=r(66747),x=r(78546),m=(r(5644),r(99616),r(53568)),p=r(490),h=r(56516),v=r(57795),Z=(r(42970),r(68238)),w=r(7510),j=(r(38686),r(68901)),b=r(49375),g=r(20636),y=(r(16126),r(23482)),k=r(20699),C=r(86760),S=r(21260),N=r.n(S),P=r(57671),z=r(92037),I=r(45696),V=r(94664),A=["values","setValue","name","errors","disabled","verifyStatusName","verifyType","sx"],T=function(e){var n=e.values,r=e.setValue,u=e.name,d=(e.errors,e.disabled),x=e.verifyStatusName,Z=e.verifyType,w=e.sx,S=(0,j.Z)(e,A),T=(0,p.Z)(),q=T.t,E=T.currentLang,F=(0,c.useState)(null),M=(0,a.Z)(F,2),D=M[0],U=M[1],W=(0,c.useState)(""),_=(0,a.Z)(W,2),L=_[0],X=_[1],B=(0,c.useState)(null),R=(0,a.Z)(B,2),J=R[0],$=R[1],G=(0,c.useState)(!1),H=(0,a.Z)(G,2),K=H[0],O=H[1],Q=(0,c.useState)(!1),Y=(0,a.Z)(Q,2),ee=Y[0],ne=Y[1];(0,c.useEffect)((function(){null===n[u]&&r((function(e){return e[u]="",(0,i.Z)({},e)}))}),[n[u]]);var re=(0,f.Ds)().enqueueSnackbar,te=(0,P.Z)(12e4,1e3),se=(0,a.Z)(te,2),ie=se[0],ae=se[1],ce=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){var r,s;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,C.default)(n[u],"any",{strictMode:!0})&&!N()(n[u],{strictMode:!0})){e.next=10;break}return e.next=3,(0,v.$Xx)({method:"mobile",locale:E.backendValue,mobile:n[u],verifyType:Z});case 3:r=e.sent,s=r.issued,re(q("TFASend"),{variant:"success"}),U(s),ae.start(12e4),e.next=11;break;case 10:re(q("mobileNumberfailText"),{variant:"error"});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O(!0),$(null),e.next=5,(0,v.dhV)({mobile:n[u],code:L,issueId:D,verifyId:n.processedUser.id,verifyType:Z});case 5:r((function(e){return e[x]=!0,(0,i.Z)({},e)})),re(q("verifySuccess"),{variant:"success"}),U(null),ne(!1),e.next=17;break;case 11:throw e.prev=11,e.t0=e.catch(0),r((function(e){return e[x]=!1,(0,i.Z)({},e)})),$((0,I.getErrorMessage)(e.t0)),re(q("verifyFailed"),{variant:"error"}),e.t0;case 17:return e.prev=17,O(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,11,17,20]])})));return function(){return e.apply(this,arguments)}}(),le=""===L||(0,z.isNil)(D),ue=Boolean(n[x]);return(0,V.jsxs)(o.Z,{sx:(0,i.Z)({my:2},w),children:[(0,V.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(m.XI,(0,i.Z)({field:u,disabled:(d||ue)&&!ee},S)),!ue||ee?(0,V.jsx)(h.C5,{onClick:ce,disabled:d||ie>0,sx:{height:54,width:100,ml:1},children:ie<=0?q("send"):ie/1e3+"s"}):(0,V.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(y.Z,{color:"success",sx:{width:50},fontSize:"small"}),(0,V.jsx)(b.Z,{disabled:d,onClick:function(){return ne(!0)},children:(0,V.jsx)(k.Z,{sx:{width:20}})})]})]}),null!==D&&(0,V.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",mt:1},children:[(0,V.jsx)(g.Z,{value:L,onChange:function(e){return X(e.target.value)},placeholder:"TFA",disabled:d}),(0,V.jsx)(h.sq,{loading:K,disabled:le||d,onClick:oe,sx:{width:100,height:54,ml:1},children:q("verify")}),J&&(0,V.jsx)(l.Z,{color:"error",sx:{width:"100%"},children:q(J)})]})]})};r(81813);function q(){var e=(0,p.Z)().t,n=(0,f.Ds)().enqueueSnackbar,r=(0,c.useState)({}),j=(0,a.Z)(r,2),b=(j[0],j[1],(0,c.useState)({})),g=(0,a.Z)(b,2),y=g[0],k=g[1],C=(0,c.useState)(!1),S=(0,a.Z)(C,2),N=S[0],P=S[1],I=(0,v.zmu)(),A=I.updateProfile,q=I.data,E=(0,v.F7J)(),F=E.data,M=E.updateUserPreference,D=(0,v.vLk)().platformFiat,U=(0,v.Un)().mutate;console.log(F);var W=(0,c.useState)((0,i.Z)((0,i.Z)((0,i.Z)({},q),q[":preference"]),{},{oldPassword:"",receiveCurrency:null===F||void 0===F?void 0:F.receiveCurrency,preferencesId:null===F||void 0===F?void 0:F.id})),_=(0,a.Z)(W,2),L=_[0],X=_[1],B=(0,c.useState)({mobile:!1,email:!1}),R=(0,a.Z)(B,2),J=R[0],$=R[1],G=(0,c.useState)((function(){return{appNotification:Boolean((0,z.get)(q,":preference.appNotification")),smsNotification:Boolean((0,z.get)(q,":preference.smsNotification")),emailNotification:Boolean((0,z.get)(q,":preference.emailNotification"))}})),H=(0,a.Z)(G,2),K=H[0],O=H[1];(0,c.useEffect)((function(){X((0,i.Z)((0,i.Z)((0,i.Z)({},q),q[":preference"]),{},{oldPassword:""}));var e=q.isMobileVerified,n=q.isEmailVerified;$((function(r){return e?(r.mobile=!0,r.email=!1,(0,i.Z)({},r)):n?(r.email=!0,r.mobile=!1,(0,i.Z)({},r)):(0,i.Z)({},r)}))}),[q]);var Q=(0,v.JAM)();console.log(q);var Y=[{label:e("ConstantEnglish"),value:"en-US"},{label:e("ConstantChinese"),value:"zh-CN"},{label:e("TraditionalChinese"),value:"zh-TW"}],ee=[{label:e("greenUpRedDown"),value:"greenUpRedDown"},{label:e("greenDownRedUp"),value:"greenDownRedUp"}],ne=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,A(q.id,{avatar:L.avatar,surname:L.surname,firstName:L.firstName,name:L.name});case 3:n(e("updateSuccess"),{variant:"success"}),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),n(e(r.t0.message),{variant:"error"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})));return function(){return r.apply(this,arguments)}}();(0,c.useEffect)((function(){X((function(e){return e.avatar=q.avatar,(0,i.Z)({},e)}))}),[]);var re=Z.object().shape({confirmPassword:Z.string().matches(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/,{message:e("password format")}).required(e("password format")).min(8,e("password format")).max(30,e("password format")),newPassword:Z.string().matches(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/,{message:e("password format")}).required(e("password format")).min(8,e("password format")).max(30,e("password format")),oldPassword:Z.string().required(e("Invalid password."))}),te=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,v.F4S)({oldPassword:L.oldPassword,password:L.newPassword});case 4:n(e("updateSuccess"),{variant:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 10:P(!1);case 11:case"end":return r.stop()}}),r,null,[[1,7]])})));return function(){return r.apply(this,arguments)}}(),se=function(){var n=(0,s.Z)((0,t.Z)().mark((function n(){return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:re.validate({oldPassword:L.oldPassword,newPassword:L.newPassword,confirmPassword:L.confirmPassword}).then((function(n){L.newPassword===L.confirmPassword?(k({}),te()):k((function(n){return n.confirmPassword=e("differentPassword"),(0,i.Z)({},n)}))})).catch((function(e){k({}),k((function(n){return n[e.path]=e.message,(0,i.Z)({},n)}))}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ie=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,v.xjl)(L.id,{locale:L.locale,stockColor:L.stockColor});case 4:U(),n(e("updateSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 11:P(!1);case 12:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(){return r.apply(this,arguments)}}(),ae=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),r.prev=1,r.next=4,(0,v.xjl)(L.id,(0,i.Z)({notificationLocale:L.notificationLocale},K));case 4:U(),n(e("updateSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(e(r.t0.message),{variant:"error"});case 11:P(!1);case 12:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(){return r.apply(this,arguments)}}(),ce=function(){var r=(0,s.Z)((0,t.Z)().mark((function r(){return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return P(!0),console.clear(),console.log(L),r.prev=3,r.next=6,M({receiveCurrency:null===L||void 0===L?void 0:L.receiveCurrency,id:null===L||void 0===L?void 0:L.preference});case 6:n(e("updateSuccess"),{variant:"success"}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(3),n(e(r.t0.message),{variant:"error"});case 12:P(!1);case 13:case"end":return r.stop()}}),r,null,[[3,9]])})));return function(){return r.apply(this,arguments)}}(),oe=(0,c.useCallback)(function(){var r=(0,s.Z)((0,t.Z)().mark((function r(s){var a;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Q(s[0]);case 3:a=r.sent,X((function(e){return e.avatar=a,(0,i.Z)({},e)})),n(e("uploadSuccess"),{variant:"success"}),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),n(e("uploadField"),{variant:"error"});case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}(),[X]),le=function(e,n){var r=q.isMobileVerified,t=q.isEmailVerified;$(r&&t?function(r){return r[n]=e.target.checked,(0,i.Z)({},r)}:function(e){return r||t?"mobile"===n?r?(e.mobile=!0,e.email=!1,(0,i.Z)({},e)):(0,i.Z)({},e):"email"===n?t?(e.email=!0,e.mobile=!1,(0,i.Z)({},e)):(0,i.Z)({},e):void 0:(0,i.Z)({},e)})};return(0,V.jsxs)(o.Z,{sx:{width:{xs:"100%",md:800},mx:"auto"},children:[(0,V.jsx)(o.Z,{sx:{backgroundColor:"background.card",py:{xs:1,md:6},px:{xs:2,md:10},borderRadius:1,display:"flex",flexDirection:"column",mt:2},children:(0,V.jsxs)(m.dz,{values:L,setValues:X,errors:y,children:[(0,V.jsxs)(o.Z,{children:[(0,V.jsx)(l.Z,{variant:"h5",children:e("userProfile")}),(0,V.jsx)(m.i_,{field:"avatar",onDrop:oe,accept:"image/*",maxSize:3145728}),"company"===(null===q||void 0===q?void 0:q.type)?(0,V.jsx)(m.XI,{field:"name",label:e("fullCompanyName"),sx:{my:1}}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(m.XI,{field:"firstName",label:e("firstName"),sx:{my:1}}),(0,V.jsx)(m.XI,{field:"surname",label:e("surname"),sx:{my:1}})]}),(0,V.jsx)(o.Z,{sx:{textAlign:"right",my:2},children:(0,V.jsx)(h.C5,{sx:{px:5},onClick:ne,children:e("submit")})})]}),(0,V.jsxs)(o.Z,{children:[(0,V.jsx)(l.Z,{variant:"h5",children:e("security")}),(0,V.jsx)(l.Z,{variant:"h6",sx:{fontSize:"13px !important",mt:2,mb:1},children:e("changePassword")}),(0,V.jsx)(m.Wz,{label:e("oldPassword"),field:"oldPassword",sx:{mt:2}}),(0,V.jsx)(m.Wz,{label:e("newPassword"),field:"newPassword",sx:{mt:2}}),(0,V.jsx)(m.Wz,{label:e("confirmPassword"),field:"confirmPassword",sx:{mt:2}}),(0,V.jsx)(o.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:se,children:e("submit")})}),(0,V.jsx)(l.Z,{variant:"h6",sx:{fontSize:"13px !important",my:2},children:e("twoFactor")}),(0,V.jsxs)(o.Z,{children:[(0,V.jsxs)(o.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("email")}),(0,V.jsx)(u.Z,{checked:null===J||void 0===J?void 0:J.email,onChange:function(e){return le(e,"email")}})]}),(null===J||void 0===J?void 0:J.email)&&(0,V.jsx)(T,{name:"email",values:L,verifyStatusName:"isEmailVerified",setValue:X,verifyType:"profile",disabled:!0})]}),(0,V.jsxs)(o.Z,{children:[(0,V.jsxs)(o.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(l.Z,{sx:{mr:1},children:e("mobile")})," ",(0,V.jsx)(d.Z,{title:e("useEmailVerify"),sx:{ml:2},children:(0,V.jsx)(x.Z,{sx:{fontSize:"18px"}})})]}),(0,V.jsx)(u.Z,{checked:null===J||void 0===J?void 0:J.mobile,onChange:function(e){return le(e,"mobile")}})]}),(null===J||void 0===J?void 0:J.mobile)&&(0,V.jsx)(T,{name:"mobile",values:L,verifyStatusName:"isMobileVerified",setValue:X,verifyType:"profile",disabled:!0})]})]}),(0,V.jsxs)(o.Z,{sx:{mt:3},children:[(0,V.jsx)(l.Z,{variant:"h6",children:e("preference")}),(0,V.jsx)(m.Nz,{options:Y,sx:{width:"100%",mt:2},size:"medium",field:"locale"}),(0,V.jsx)(m.Nz,{options:ee,sx:{width:"100%",mt:2},size:"medium",field:"stockColor"}),(0,V.jsx)(o.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:ie,children:e("submit")})})]}),(0,V.jsxs)(o.Z,{sx:{mt:3},children:[(0,V.jsx)(l.Z,{variant:"h6",children:e("notificationSettings")}),(0,V.jsxs)(o.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("appNotification")}),(0,V.jsx)(u.Z,{checked:null===K||void 0===K?void 0:K.appNotification,onChange:function(e){return O((function(e){return(0,i.Z)((0,i.Z)({},e),{},{appNotification:!e.appNotification})}))}})]}),(0,V.jsxs)(o.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("smsNotification")}),(0,V.jsx)(u.Z,{checked:null===K||void 0===K?void 0:K.smsNotification,onChange:function(e){return O((function(e){return(0,i.Z)((0,i.Z)({},e),{},{smsNotification:!e.smsNotification})}))},disabled:!(0,z.get)(q,"isMobileVerified")})]}),(0,V.jsxs)(o.Z,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)(l.Z,{children:e("emailNotification")}),(0,V.jsx)(u.Z,{checked:null===K||void 0===K?void 0:K.emailNotification,onChange:function(e){return O((function(e){return(0,i.Z)((0,i.Z)({},e),{},{emailNotification:!e.emailNotification})}))},disabled:!(0,z.get)(q,"isEmailVerified")})]}),(0,V.jsx)(m.Nz,{options:Y,sx:{width:"100%",mt:2},size:"medium",field:"notificationLocale"}),(0,V.jsx)(o.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:ae,children:e("submit")})})]}),(0,V.jsxs)(o.Z,{sx:{mt:2},children:[(0,V.jsx)(l.Z,{children:e("settingUserDefaultCurrency")}),(0,V.jsx)(m.Nz,{field:"receiveCurrency",options:D,sx:{width:1,mt:1}})]}),(0,V.jsx)(o.Z,{sx:{textAlign:"right",mt:2},children:(0,V.jsx)(h.sq,{sx:{px:5},onClick:ce,children:e("submit")})})]})}),(0,V.jsx)(w.Z,{loading:N})]})}},81813:function(e,n,r){var t=r(75782),s=r(99932),i=r(78450),a=r(52398),c=r(68901),o=r(72722),l=r(20636),u=r(75625),d=r(54127),f=r(16126),x=r(56516),m=r(23482),p=r(490),h=r(86760),v=r(21260),Z=r.n(v),w=r(57671),j=r(92037),b=r(66747),g=r(57795),y=r(45696),k=r(94664),C=["values","setValue","name","errors","disabled","verifyStatusName","sx"],S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(null===e||void 0===e?void 0:e.startsWith("+86"))&&14===e.length};n.Z=function(e){var n=e.values,r=e.setValue,v=e.name,N=(e.errors,e.disabled),P=e.verifyStatusName,z=e.sx,I=(0,c.Z)(e,C),V=(0,p.Z)(),A=V.t,T=V.currentLang,q=(0,d.useState)(null),E=(0,a.Z)(q,2),F=E[0],M=E[1],D=(0,d.useState)(""),U=(0,a.Z)(D,2),W=U[0],_=U[1],L=(0,d.useState)(null),X=(0,a.Z)(L,2),B=X[0],R=X[1],J=(0,d.useState)(!1),$=(0,a.Z)(J,2),G=$[0],H=$[1];(0,d.useEffect)((function(){null===n[v]&&r(v,"")}),[n[v]]);var K=(0,b.Ds)().enqueueSnackbar,O=(0,w.Z)(12e4,1e3),Q=(0,a.Z)(O,2),Y=Q[0],ee=Q[1],ne=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){var r,t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,h.default)(n[v],"any",{strictMode:!0})&&!Z()(n[v],{strictMode:!0})){e.next=10;break}return e.next=3,(0,g.$Xx)({method:"mobile",locale:T.backendValue,mobile:n[v]});case 3:r=e.sent,t=r.issued,K(A("TFASend"),{variant:"success"}),M(t),ee.start(12e4),e.next=11;break;case 10:K(A("mobileNumberfailText"),{variant:"error"});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,H(!0),R(null),e.next=5,(0,g.dhV)({mobile:n[v],code:W,issueId:F,verifyId:n.verifyId});case 5:r(P,!0),K(A("verifySuccess"),{variant:"success"}),e.next=15;break;case 9:throw e.prev=9,e.t0=e.catch(0),r(P,!1),R((0,y.getErrorMessage)(e.t0)),K(A("verifyFailed"),{variant:"error"}),e.t0;case 15:return e.prev=15,H(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,9,15,18]])})));return function(){return e.apply(this,arguments)}}(),te=""===W||(0,j.isNil)(F),se=Boolean(n[P]);return(0,k.jsxs)(o.Z,{sx:(0,t.Z)({my:2},z),children:[(0,k.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(f.au,(0,t.Z)({name:v,disabled:N||se},I)),se?(0,k.jsx)(m.Z,{color:"success",sx:{width:50},fontSize:"small"}):(0,k.jsx)(x.C5,{onClick:ne,disabled:N||Y>0||S(n[v]),sx:{height:54,width:100,ml:1},children:Y<=0?A("send"):Y/1e3+"s"})]}),null!==F&&!se&&(0,k.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,k.jsx)(l.Z,{value:W,onChange:function(e){return _(e.target.value)},placeholder:"TFA",disabled:N}),(0,k.jsx)(x.sq,{loading:G,disabled:te||se||N,onClick:re,sx:{width:100,height:54,ml:1},children:A("verify")}),B&&(0,k.jsx)(u.Z,{color:"error",sx:{width:"100%"},children:A(B)})]})]})}}}]);