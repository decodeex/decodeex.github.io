"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[5984],{79418:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(92680),o=t(24190),i=t(12130),s=t(31530),a=t(26521),c=t(24786),l=(t(29367),t(28418)),u=t(18858),d=t(88658),f=(t(14674),t(98845));function p(e){var n=e.open,t=e.onClose,p=e.onResetPassword,v=e.type,x=e.ticket,h=e.clientApi,m=e.mutate,g=void 0===m?function(){}:m,Z=e.closeAll,w=(0,d.Z)().t,b=(0,s.useState)(!1),y=(0,i.Z)(b,2),k=y[0],j=y[1],S=(0,s.useState)({}),C=(0,i.Z)(S,2),D=(C[0],C[1],(0,s.useState)({})),P=(0,i.Z)(D,2),W=(P[0],P[1],(0,s.useState)(!1)),N=(0,i.Z)(W,2),T=(N[0],N[1],(0,l.Ds)().enqueueSnackbar),z=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j(!0),"positions"!==v){e.next=15;break}if(Z){e.next=9;break}return e.next=6,null===h||void 0===h?void 0:h.closePosition(x);case 6:n=e.sent,e.next=13;break;case 9:return console.log("aaaaa"),e.next=12,null===h||void 0===h?void 0:h.closeAll();case 12:n=e.sent;case 13:e.next=24;break;case 15:if(Z){e.next=21;break}return e.next=18,null===h||void 0===h?void 0:h.cancelOrder(x);case 18:n=e.sent,e.next=24;break;case 21:return e.next=23,null===h||void 0===h?void 0:h.cancelAll();case 23:n=e.sent;case 24:return console.log(n),e.next=27,g();case 27:T(w("positions"===v?"tradeCloseSuccess":"tradeCancelSuccess"),{variant:"success"}),j(!1),t(),e.next=36;break;case 32:e.prev=32,e.t0=e.catch(0),j(!1),"incorrectPassword"===e.t0.message?(T(w("incorrectPassword"),{variant:"error"}),t(),p()):T(w(e.t0.message),{variant:"error"});case 36:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return(0,f.jsx)(u.ZP,{open:n,onClose:t,save:z,saveLoading:k,children:(0,f.jsx)(a.Z,{sx:{width:400,mx:"auto",textAlign:"center"},children:(0,f.jsx)(c.Z,{sx:{mb:2,fontSize:18},children:w(Z?"positions"===v?"whetherToCloseAll":"cancelPendingAll":"positions"===v?"whetherToClose":"cancelPending")})})})}},64965:function(e,n,t){t(31530);var r=t(47006),o=t(27203),i=t(98845);n.Z=function(e){var n=e.loading;return(0,i.jsx)(r.Z,{sx:{zIndex:"9999999"},open:n,children:(0,i.jsx)(o.Z,{})})}},3205:function(e,n,t){t.d(n,{W:function(){return p}});var r=t(12130),o=(t(10083),t(88658)),i=(t(62428),t(64505),t(26521)),s=t(2458),a=t(24786),c=t(99317),l=t(96390),u=(t(28418),t(31530)),d=(t(64965),t(39702)),f=t(98845),p=function(e){var n,t=e.children,p=e.item,v=(0,u.useState)(null),x=(0,r.Z)(v,2),h=x[0],m=x[1],g=(0,o.Z)().t,Z=function(){m(null)},w=Boolean(h),b=[{label:"S/L",value:(0,d.isNil)((0,d.get)(p,"stopLossing"))?"-":(0,l.DU)((0,d.get)(p,"stopLossing"))},{label:g("swap"),value:(0,d.isNil)((0,d.get)(p,"swap"))?"-":(0,l.DU)((0,d.get)(p,"swap"))},{label:"T/P",value:(0,d.isNil)((0,d.get)(p,"takeProfit"))?"-":(0,l.DU)((0,d.get)(p,"takeProfit"))},{label:g("taxes"),value:(0,d.isNil)((0,d.get)(p,"taxes"))?"-":(0,l.DU)((0,d.get)(p,"taxes"))},{label:"ID",value:(0,d.get)(p,"ticket")},{label:g("charges"),value:(0,d.isNil)((0,d.get)(p,"charges"))?"-":(0,l.DU)((0,d.get)(p,"charges"))},"1970-01-01T00:00:00.000Z"===(null===p||void 0===p||null===(n=p.rawData)||void 0===n?void 0:n.closeTime)?{}:{label:g("tradeCloseTime"),value:(0,l.o0)((0,d.get)(p,"rawData.closeTime"))}];return(0,f.jsxs)(i.Z,{onMouseEnter:function(e){m(e.currentTarget)},onMouseLeave:Z,children:[t,(0,f.jsx)(s.ZP,{id:"mouse-over-popover",sx:{pointerEvents:"none"},open:w,anchorEl:h,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:Z,disableRestoreFocus:!0,children:(0,f.jsxs)(i.Z,{px:3,py:2,sx:{width:400},children:[(0,f.jsx)(a.Z,{sx:{fontSize:12,mb:1},children:(0,d.isNil)((0,d.get)(p,"rawData.openTime"))?"-":(0,l.o0)((0,d.get)(p,"rawData.openTime"))}),(0,d.chunk)(b,2).map((function(e,n){return(0,f.jsx)(c.Z,{direction:"row",alignItems:"center",spacing:3,children:e.map((function(e,n){return(0,f.jsxs)(c.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",flex:1,children:[(0,f.jsx)(a.Z,{sx:{fontSize:12},children:(0,d.get)(e,"label")}),(0,f.jsx)(a.Z,{sx:{fontSize:12},children:(0,d.get)(e,"value")})]},n)}))},n)}))]})})]})}},95984:function(e,n,t){t.d(n,{Z:function(){return V}});var r=t(16487),o=t(92680),i=t(24190),s=t(2211),a=t(12130),c=t(10083),l=t(88658),u=t(62428),d=t(64505),f=t(24786),p=t(26521),v=t(2458),x=t(3019),h=t(96390),m=t(28418),g=t(31530),Z=t(64965),w=t(39702),b=t(3205),y=t(29231),k=t(14674),j=t(79418),S=t(87749),C=t(43248),D=t(95434),P=t(68468),W=t(88851),N=t(82177),T=P.url.join("wss://mt4-api.decodeex.com/","/"),z=(0,N.ZP)((function(e,n){return{response:[]}})),A=new W.Z(T,(function(e){var n=JSON.parse(e.data).map((function(e){return{symbol:e.s,contractSize:e.n,currency:e.c,digits:e.d}})),t=(0,w.keyBy)(n,"symbol");z.setState({response:n,KVResponse:t})})),I=function(e){var n=(0,g.useRef)(!1),t=(0,g.useRef)([]),r=(0,g.useId)();(0,w.isNil)(e)||0===e.length?(n.current=!1,t.current=[]):n.current&&t.current===e||(n.current=!0,t.current=e,A.send_({c:"symbol",ls:e,r:r},!0))},F=t(48466),O=(0,N.ZP)((function(e,n){return{response:{}}})),R=P.url.join("wss://mt4-api.decodeex.com/","/"),_=new W.Z(R,(function(e){var n=JSON.parse(e.data),t=n.s,r=n.b,o=n.a,i=n.o;n.h,n.l,n.c,n.v;null==i&&O.setState({response:(0,s.Z)((0,s.Z)({},O.getState().response),{},(0,F.Z)({},t,(0,s.Z)((0,s.Z)({},O.getState().response[t]||{}),{},(0,F.Z)({},"std",{bid:r,ask:o}),z.getState().KVResponse[t]||{})))})})),E=function(){var e=(0,g.useMemo)((function(){return{watch:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"subm",ls:n},!0));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),unwatch:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"unsubm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),watchQuote:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"subm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),unwatchQuote:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"unsubm"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),watchHist:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"ohlc"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),unwatchHist:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.send_({c:"unohlc"},!0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}),[]);return e},H=function(e,n,t,r,o,i){var s=t+n,a=r[s],c=(0,w.get)(a,"std");return null!=a&&c?(0===o?e/c.bid:e/c.ask).toFixed(2):(a=r[s=n+t],c=(0,w.get)(a,"std"),null!=a&&c?(0===o?e*c.bid:e*c.ask).toFixed(2):null)},L=t(98845),U=(0,g.memo)((function(e){var n=e.item,t=(0,g.useRef)();return(0,g.useEffect)((function(){var e=O.subscribe((function(e){var r=e.response[n.symbol];if(r){var o=r.std;t.current&&o&&(t.current.innerHTML=(0,y.currencyFormatorWithDecimal)([0,2,4].includes(n.rawData.cmd)?o.bid:o.ask,"",2,!0))}}));return function(){e()}}),[n.symbol]),(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},ref:t,children:(0,y.currencyFormatorWithDecimal)(n.currentPrice,"",2,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),q=(0,g.memo)((function(e){var n=e.item,t=(0,g.useRef)();return(0,g.useEffect)((function(){var e=z.subscribe((function(e){e.response;var r=(0,w.find)(e.response,(function(e){return e.symbol===n.symbol}));r&&t.current&&(t.current.innerHTML=(0,y.currencyFormatorWithDecimal)(n.startPrice,"",r.digits,!0))}));return function(){e()}}),[n.symbol]),(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},ref:t,children:(0,y.currencyFormatorWithDecimal)(n.startPrice,"",n.digits,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),M=(0,g.memo)((function(e){var n=e.item,t=(0,g.useRef)(),r=(0,D.F)().getStockColorValue;return(0,g.useEffect)((function(){var e=O.subscribe((function(e){var o=e.response,i=o[n.symbol];if(i){var s=i.std;if(s){var a,c=function(e,n,t,r,o,i,s){var a=e.cmd,c=e.volume,l=e.openPrice,u=(e.accountGroupType,c/100*r),d=0;if(d=0===a?((n-l)*u).toFixed(2):((l-t)*u).toFixed(2),o!==i){var f=H(d,o,i,s,a);return null!=f?f:null==(f=H(d,o,"USD",s,a))||null==(f=H(f,"USD",i,s,a))?0:f}return d}(n.rawData,s.bid,s.ask,i.contractSize,i.currency,null===(a=n.rawData)||void 0===a?void 0:a.accountCurrency,o);t.current.innerHTML=(0,y.currencyFormatorWithDecimal)(c,"",2,!0),t.current.style.color=r(c)}}}));return function(){e()}}),[n.symbol]),(0,L.jsx)(f.Z,{sx:{fontSize:"12px",fontWeight:700,color:r(n.profit)},ref:t,children:(0,y.currencyFormatorWithDecimal)(n.profit,"",2,!0)})}),(function(e,n){var t,r;return(null===e||void 0===e||null===(t=e.item)||void 0===t?void 0:t.symbol)===(null===n||void 0===n||null===(r=n.item)||void 0===r?void 0:r.symbol)})),V=(0,g.forwardRef)((function(e,n){var t=e.type,y=e.autoHeight,P=void 0!==y&&y,W=e.login,N=e.home,T=void 0!==N&&N,A=e.hidePagination,F=void 0===A||A,O=e.closeAll,R=void 0!==O&&O,_=e.setCloseAll,H=void 0===_?function(){}:_,V=e.forexAccountId,B=e.setDisabled,J=void 0===B?function(){}:B,K=(0,l.Z)().t,G=(0,m.Ds)().enqueueSnackbar,Q=(0,g.useState)(!1),X=(0,a.Z)(Q,2),Y=X[0],$=X[1],ee=(0,g.useState)(null),ne=(0,a.Z)(ee,2),te=ne[0],re=ne[1],oe=(0,g.useState)(W),ie=(0,a.Z)(oe,2),se=ie[0],ae=ie[1],ce=(0,g.useState)(null),le=(0,a.Z)(ce,2),ue=le[0],de=le[1],fe=(0,g.useState)(!1),pe=(0,a.Z)(fe,2),ve=pe[0],xe=pe[1],he=(0,g.useState)(!1),me=(0,a.Z)(he,2),ge=me[0],Ze=me[1],we=(0,g.useState)({}),be=(0,a.Z)(we,2),ye=be[0],ke=be[1],je=((0,C.Z)().user,(0,D.F)().getStockColorValue,(0,u.mxK)((0,s.Z)({type:t,login:W},T&&"closed"===t?{startDate:(0,h.xA)(new Date((new Date).getTime()-5184e5).toISOString()),endDate:(0,h.xA)((new Date).toISOString())}:{}))),Se=je.data,Ce=je.mutate,De=je.isValidating,Pe=function(){setTimeout((function(){Ce()}),400)},We=(0,u.OhN)({accountId:ue||V}).data;!function(e){I(e);var n=E();(0,g.useEffect)((function(){if(!(0,w.isNil)(e)&&0!==e.length){var t=z.subscribe((function(e){var t=e.response;console.log("watch symbols",t.map((function(e){return e.symbol}))),n.watch(t.map((function(e){return e.symbol})))}));return function(){t&&t(),n.unwatch()}}n.unwatch()}),[e])}("closed"===t?null:(0,w.uniq)(Se.map((function(e){return e.symbol})))),(0,g.useEffect)((function(){R&&Ze(!0)}),[R]),(0,g.useEffect)((function(){console.log(Se),Se.length>0?J(!1):J(!0)}),[De]);var Ne=(0,k.Z)(null===We||void 0===We?void 0:We.login,null===We||void 0===We?void 0:We.password,null===We||void 0===We?void 0:We.groupType),Te=function(){re(null)};(0,g.useImperativeHandle)(n,(function(){return{resetValue:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),firstTrade:null===Se||void 0===Se?void 0:Se[0]}}),[n]);var ze=Boolean(te),Ae=ze?"simple-popover":void 0,Ie=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(!0),e.prev=1,e.next=4,(0,u.Hq6)(n);case 4:return e.next=6,Pe();case 6:G(K("updateSuccess"),{variant:"success"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),G("".concat(K("updateFailed"),": ").concat(JSON.parse(e.t0.message).error.message),{variant:"error"});case 13:$(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}(),Fe=[{headerName:K("login"),field:"login",flex:1,minWidth:80,renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},children:(0,w.get)(n,"rawData.login")})})}},{headerName:K("lot"),field:"lot",flex:.5,minWidth:60,renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},children:(0,h.DU)(n.lot)})})}},{headerName:K("symbol"),field:"symbol",flex:.5,minWidth:75,renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},children:(0,w.get)(n,"displaySymbol")})})}},{headerName:K("type"),field:"type",flex:.5,minWidth:60,renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(f.Z,{sx:{fontSize:"12px"},children:(0,w.get)(n,"orderCommand")})})}},{headerName:K("open"===t?"forexPendingOpenPrice":"forexOpenPrice"),field:"openPrice",minWidth:110,flex:1,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(q,{item:n})})}},{headerName:K("closed"===t?"forexClosedClosePrice":"forexNormalClosePrice"),field:"closePrice",minWidth:110,flex:1,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(U,{item:n})})}},{headerName:K("tradeCloseTime"),field:"closeTime",flex:1,minWidth:130,hide:"closed"!==t,renderCell:function(e){var n=e.row;return(0,L.jsxs)(b.W,{item:n,children:[(0,L.jsx)(f.Z,{sx:{fontSize:"12px",textOverflow:"ellipsis",overflow:"hidden",width:"100%"},children:(0,h.o0)(n.rawData.closeTime)})," "]})}}].concat((0,r.Z)("open"===t?[]:[{headerName:K("profit"),field:"profit",flex:1,minWidth:100,align:"right",headerAlign:"right",renderCell:function(e){var n=e.row;return(0,L.jsx)(b.W,{item:n,children:(0,L.jsx)(M,{item:n})})}}]),[{headerName:K("actions"),field:"action",flex:1,minWidth:120,hide:"closed"===t,renderCell:function(e){var n=e.row;return(0,L.jsx)(p.Z,{children:"closed"!==t&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center"},onClick:function(e){ke(n),ae(n.login),de(n.rawData.accountId),n.hasPassword?(Ze(!0),ae(n.rawData.accountId)):(ae(n.rawData.accountId),xe(!0))},children:[(0,L.jsx)(p.Z,{sx:{backgroundColor:"primary.rise",height:15,width:15,borderRadius:"50%",display:"flex",alignItems:"center",justifyItems:"center",textAlign:"center"},children:"positions"!==t?(0,L.jsx)(x.Z,{fontSize:"18px",sx:{color:"#fff"}}):(0,L.jsx)("img",{src:"/assets/icons/shut-down-line.svg",style:{width:"12px",position:"relative",left:"1px"}})}),(0,L.jsx)(f.Z,{sx:{fontSize:"12px",color:"primary.rise",ml:1},children:K("positions"===t?"positionClose":"cancel")})]}),(0,L.jsx)(v.ZP,{id:Ae,open:ze&ye.ticket===n.ticket,anchorEl:te,onClose:Te,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,L.jsxs)(p.Z,{sx:{width:200,textAlign:"center",py:1},children:[(0,L.jsx)(f.Z,{sx:{mb:1},children:K("positions"===t?"whetherToClose":"cancelPending")}),(0,L.jsx)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center",mr:1},onClick:Te,children:K("cancel")}),(0,L.jsx)(d.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center"},onClick:(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n.rawData.hasPassword){e.next=5;break}Te(),xe(!0),e.next=8;break;case 5:return Te(),e.next=8,Ie({ticket:n.ticket,type:"positions"===t?"positions":"open",login:n.login});case 8:case"end":return e.stop()}}),e)}))),children:K("confirm")})]})})]})})}}]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(p.Z,{sx:{"& .style-header":{fontSize:14,backgroundColor:"#3C3C50",height:36,fontWeight:"bold"},"& .MuiDataGrid-columnHeaders":{borderRadius:0},height:"100%"},children:[(0,L.jsx)(c.Z,{columns:Fe,rows:Se,headerClassName:"style-header",cellClassName:"style-cell",hideFooter:!0,hidePagination:F,autoHeight:P}),(0,L.jsx)(j.Z,{open:ge,onClose:function(){Ze(!1),H(!1)},onResetPassword:function(){return xe(!0)},accountLogin:null===We||void 0===We?void 0:We.login,password:null===We||void 0===We?void 0:We.password,groupType:null===We||void 0===We?void 0:We.groupType,type:t,ticket:ye.ticket,clientApi:Ne,mutate:Pe,closeAll:R}),(0,L.jsx)(S.Z,{open:ve,onClose:function(){return xe(!1)},forexAccountId:se,onSuccess:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("---------------------"),"positions"!==t){e.next=13;break}if(R){e.next=9;break}return e.next=5,null===n||void 0===n?void 0:n.closePosition(null===ye||void 0===ye?void 0:ye.ticket);case 5:r=e.sent,console.log(r),e.next=11;break;case 9:return e.next=11,null===n||void 0===n?void 0:n.closeAll();case 11:case 16:e.next=20;break;case 13:if(R){e.next=18;break}return e.next=16,null===n||void 0===n?void 0:n.cancelOrder(null===ye||void 0===ye?void 0:ye.ticket);case 18:return e.next=20,null===n||void 0===n?void 0:n.cancelAll();case 20:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})]}),(0,L.jsx)(Z.Z,{loading:Y})]})}))}}]);