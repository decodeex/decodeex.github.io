"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[7116],{17116:function(e,r,n){n.r(r),n.d(r,{default:function(){return R}});var t=n(54869),o=n(57833),s=n(83925),c=n(98554),a=n(51978),d=n(65978),i=n(75782),u=n(99932),l=n(78450),m=n(52398),f=n(2028),p=n(99350),x=n(22105),h=n(17969),v=n(85777),g=n(88204),Z=n(89038),w=n(74361),j=n(83668),b=n(26),y=n(21380),q=n(79848),$=n(29364),I=n(53944),S=n(6314),C=n(5851),_=n(68846),A=n(2898),k=n(70289);function W(){var e=(0,x.s0)(),r=(0,A.Z)().t,n=(0,x.TH)(),t=(0,p.Ds)().enqueueSnackbar,o=(0,h.useState)({}),c=(0,m.Z)(o,2),a=c[0],d=c[1];console.log(n);var W=(0,h.useState)(!1),z=(0,m.Z)(W,2),P=z[0],R=z[1],E=sessionStorage.getItem("email-recovery"),D=f.object().shape({code1:f.string().required(r("codeIsRequired")),code2:f.string().required(r("codeIsRequired")),code3:f.string().required(r("codeIsRequired")),code4:f.string().required(r("codeIsRequired")),code5:f.string().required(r("codeIsRequired")),code6:f.string().required(r("codeIsRequired")),email:f.string().email(r("pleaseInputCorrectEmail")).required(r("pleaseInputCorrectEmail")),password:f.string().required(r("password format")).matches(/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/,{message:r("password format")}).min(6,r("password format")).max(30,r("password format")),confirmPassword:f.string().required(r("password format")).matches(/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/,{message:r("password format")}).min(6,r("password format")).max(30,r("password format")).oneOf([f.ref("password"),null],r("differentPassword"))}),L={code1:"",code2:"",code3:"",code4:"",code5:"",code6:"",email:E||"",password:"",confirmPassword:""},V=(0,v.cI)({mode:"all",resolver:(0,g.X)(D),defaultValues:L}),N=V.control,H=V.setValue,B=V.handleSubmit,F=V.formState,G=F.isSubmitting,J=F.errors;(0,h.useEffect)((function(){var e=document.querySelector("input.field-code");return null===e||void 0===e||e.addEventListener("paste",O),function(){null===e||void 0===e||e.removeEventListener("paste",O)}}),[]);var O=function(e){var r=e.clipboardData.getData("text");r=r.split(""),[].forEach.call(document.querySelectorAll(".field-code"),(function(e,n){e.value=r[n];var t="code".concat(n+1);H(t,r[n])})),e.preventDefault()},Q=function(){var o=(0,l.Z)((0,u.Z)().mark((function o(s){return(0,u.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,_.GsL)({code:"".concat(s.code1).concat(s.code2).concat(s.code3).concat(s.code4).concat(s.code5).concat(s.code6),password:s.password,issueId:(null===a||void 0===a?void 0:a.issueId)||n.state.issueId,id:(null===a||void 0===a?void 0:a.id)||n.state.id});case 3:console.log("data:",{email:s.email,code:"".concat(s.code1).concat(s.code2).concat(s.code3).concat(s.code4).concat(s.code5).concat(s.code6),password:s.password}),sessionStorage.removeItem("email-recovery"),t("Change password success!"),e(I.cR.root,{replace:!0}),o.next=13;break;case 9:o.prev=9,o.t0=o.catch(0),t(r(o.t0.message),{variant:"error"}),console.error(o.t0);case 13:case"end":return o.stop()}}),o,null,[[0,9]])})));return function(e){return o.apply(this,arguments)}}(),T=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,_.beD)(E);case 3:n=e.sent,d(n),t("Send verify code success!"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(r(e.t0.message),{variant:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return(0,k.jsxs)(C.RV,{methods:V,onSubmit:B(Q),children:[(0,k.jsxs)(Z.Z,{spacing:3,children:[(0,k.jsx)(C.au,{name:"email",label:r("email"),disabled:!!E}),(0,k.jsx)(Z.Z,{direction:"row",spacing:2,justifyContent:"center",children:["code1","code2","code3","code4","code5","code6"].map((function(e,r){return(0,k.jsx)(v.Qr,{name:"code".concat(r+1),control:N,render:function(e){var n=e.field,t=e.fieldState.error;return(0,k.jsx)(w.Z,(0,i.Z)((0,i.Z)({},n),{},{error:!!t,autoFocus:0===r,placeholder:"-",onChange:function(e){return function(e,r){var n=e.target,t=n.maxLength,o=n.value,s=n.name.replace("code",""),c=Number(s);if(o.length>=t&&c<6){var a=document.querySelector("input[name=code".concat(c+1,"]"));null!==a&&a.focus()}r(e)}(e,n.onChange)},inputProps:{className:"field-code",maxLength:1,sx:{p:0,textAlign:"center",width:{xs:36,sm:56},height:{xs:36,sm:56}}}}))}},e)}))}),(!!J.code1||!!J.code2||!!J.code3||!!J.code4||!!J.code5||!!J.code6)&&(0,k.jsx)(j.Z,{error:!0,sx:{px:2},children:r("codeIsRequired")}),(0,k.jsx)(C.au,{name:"password",label:r("password"),type:P?"text":"password",InputProps:{endAdornment:(0,k.jsx)(b.Z,{position:"end",children:(0,k.jsx)(y.Z,{onClick:function(){return R(!P)},edge:"end",children:(0,k.jsx)(S.Z,{icon:P?"eva:eye-fill":"eva:eye-off-fill"})})})}}),(0,k.jsx)(C.au,{name:"confirmPassword",label:r("confirm password"),type:P?"text":"password",InputProps:{endAdornment:(0,k.jsx)(b.Z,{position:"end",children:(0,k.jsx)(y.Z,{onClick:function(){return R(!P)},edge:"end",children:(0,k.jsx)(S.Z,{icon:P?"eva:eye-fill":"eva:eye-off-fill"})})})}}),(0,k.jsx)($.Z,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:G,sx:{mt:3},children:r("submit")})]}),(0,k.jsxs)(s.Z,{variant:"body2",sx:{mt:1},children:[r("noCode")," \xa0",(0,k.jsx)(q.Z,{variant:"subtitle2",onClick:function(){T()},children:r("resend")})]})]})}var z=n(49968),P=(0,t.ZP)("div")((function(e){return{maxWidth:480,margin:"auto",minHeight:"100vh",display:"flex",justifyContent:"center",flexDirection:"column",padding:e.theme.spacing(12,0)}}));function R(){var e=(0,A.Z)().t;return(0,k.jsxs)(d.Z,{title:"New Password",children:[(0,k.jsx)(a.Z,{}),(0,k.jsx)(o.Z,{children:(0,k.jsxs)(P,{sx:{textAlign:"center"},children:[(0,k.jsx)(z.Jg,{sx:{mb:5,mx:"auto",height:120}}),(0,k.jsxs)(s.Z,{variant:"h3",gutterBottom:!0,children:[e("Send Success"),"!"]}),(0,k.jsxs)(s.Z,{sx:{color:"text.secondary"},children:[e("sendedEmail"),(0,k.jsx)("br",{}),e("enterVerifyCode")]}),(0,k.jsx)(c.Z,{sx:{mt:5,mb:3},children:(0,k.jsx)(W,{})})]})})]})}}}]);