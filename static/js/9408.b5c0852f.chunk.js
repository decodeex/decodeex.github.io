"use strict";(self.webpackChunk_decode_crm_client=self.webpackChunk_decode_crm_client||[]).push([[9408],{9408:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var s=t(2211),r=t(12130),o=t(99317),a=t(11001),c=t(26929),i=t(7633),l=t(92680),u=t(24190),d=t(2458),p=t(26521),x=t(24786),h=t(64505),f=(t(81452),t(88658)),Z=t(56383),g=t(31530),m=t(34337),v=t(49105),j=t(95984),k=t(28418),b=t(64965),w=t(62428),C=t(79418),y=t(98647),A=t(98845);function S(e){var n=e.accountId,t=e.login,o=(0,f.Z)().t,c=(0,g.useState)(null),i=(0,r.Z)(c,2),v=i[0],S=i[1],I=(0,g.useState)(!1),P=(0,r.Z)(I,2),T=P[0],D=P[1],H=(0,g.useState)(!1),_=(0,r.Z)(H,2),q=_[0],O=_[1],z=(0,g.useState)(!1),N=(0,r.Z)(z,2),V=N[0],W=N[1],B=(0,g.useState)(!0),E=(0,r.Z)(B,2),F=E[0],G=E[1],K=(0,k.Ds)().enqueueSnackbar,M=(0,y.W)(),R=(0,g.useRef)(null),X=(0,g.useState)("positions"),J=(0,r.Z)(X,2),L=J[0],Q=J[1],U=function(){S(null)},Y=Boolean(v),$=Y?"simple-popover":void 0,ee=[{name:o("forexPendingOrder"),value:"positions"},{name:o("forexOpenOrder"),value:"open"},{name:o("closedTrades"),value:"closedTrades"},{name:o("tradeTransactions"),value:"transactions"}],ne=function(){var e=(0,u.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"positions"!==L){e.next=12;break}return O(!0),U(),e.next=6,(0,w.zXq)((0,s.Z)({login:t},n?{password:n}:{}));case 6:O(!1),K(o("updateSuccess"),{variant:"success"}),R.current.resetValue(),M(/balanceHook/),e.next=20;break;case 12:return O(!0),U(),e.next=16,(0,w.HdN)((0,s.Z)({login:t},n?{password:n}:{}));case 16:O(!1),K(o("updateSuccess"),{variant:"success"}),R.current.resetValue(),M(/balanceHook/);case 20:e.next=28;break;case 22:e.prev=22,e.t0=e.catch(0),console.clear(),console.log(e.t0),O(!1),K(o(e.t0.message),{variant:"error"});case 28:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(n){return e.apply(this,arguments)}}();return(0,A.jsxs)(a.rg,{sx:{p:0},children:[(0,A.jsx)(p.Z,{sx:{p:2},children:(0,A.jsx)(a.ll,{leftComponent:function(){return(0,A.jsx)(h.pn,{btns:ee,onChange:function(e,n){Q(e)}})},rightComponent:function(){return(0,A.jsxs)(A.Fragment,{children:[t&&("positions"===L||"open"===L)&&(0,A.jsx)(h.sq,{onClick:function(e){W(!0)},size:"small",sx:{backgroundColor:"#505064",p:0,py:.3,px:1,color:"primary.rise",alignItems:"center"},disabled:F,children:o("positions"===L?"closeAll":"cancelAll")}),(0,A.jsx)(d.ZP,{id:$,open:Y,anchorEl:v,onClose:U,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,A.jsxs)(p.Z,{sx:{width:200,textAlign:"center",py:1},children:[(0,A.jsx)(x.Z,{sx:{mb:1},children:o("positions"===L?"whetherToCloseAll":"cancelPendingAll")}),(0,A.jsx)(h.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center",mr:1},onClick:U,children:o("cancel")}),(0,A.jsx)(h.sq,{sx:{backgroundColor:"#505064",p:0,py:.3,px:1,alignItems:"center"},onClick:(0,u.Z)((0,l.Z)().mark((function e(){var n,t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(null===(n=R.current.firstTrade)||void 0===n||null===(t=n.rawData)||void 0===t?void 0:t.hasPassword)){e.next=5;break}U(),D(!0),e.next=7;break;case 5:return e.next=7,ne();case 7:case"end":return e.stop()}}),e)}))),children:o("confirm")})]})})]})}})}),(0,A.jsxs)(p.Z,{children:["positions"===L&&(0,A.jsx)(j.Z,{type:"positions",autoHeight:!0,hidePagination:!0,login:t,forexAccountId:n,ref:R,closeAll:V,setCloseAll:W,setDisabled:G}),"open"===L&&(0,A.jsx)(j.Z,{type:"open",autoHeight:!0,login:t,forexAccountId:n,hidePagination:!0,ref:R,closeAll:V,setCloseAll:W,setDisabled:G}),"transactions"===L&&(0,A.jsx)(Z.Z,{accountId:n}),"closedTrades"===L&&(0,A.jsx)(m.Z,{login:t})]}),(0,A.jsx)(b.Z,{loading:q}),(0,A.jsx)(C.Z,{open:T,onClose:function(){return D(!1)},callback:function(){var e=(0,u.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ne(n);case 3:D(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),D(!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n){return e.apply(this,arguments)}}()})]})}t(81514);t(93534);var I=t(43248),P=t(42733),T=t(64234);t(66133);function D(e){var n=(0,f.Z)().t,t=(0,g.useState)("transactions"),s=(0,r.Z)(t,2);s[0],s[1],n("transactions"),n("Today's trades");return(0,A.jsxs)(a.rg,{sx:{p:0},children:[(0,A.jsx)(p.Z,{sx:{pt:2}}),(0,A.jsx)(v.Z,{autoHeight:!0})]})}var H="/api/ws";new(t(88465).dK)("https://crm-api.decodeex.com",{path:H.endsWith("/")?H:"/api/ws/",reconnectionDelayMax:1e4,transports:["websocket"],autoConnect:!1});function _(){var e=(0,P.p)(),n=(0,T.useSearchParams)(),t=(0,r.Z)(n,1)[0],a=((0,I.Z)().user,t.get("id")),l=t.get("login");return(0,A.jsxs)(o.Z,{direction:"row",sx:{height:"100%",flexDirection:{xs:"column",md:"row"}},children:[(0,A.jsx)(o.Z,{spacing:1,sx:{width:375,height:"100%"},children:(0,A.jsx)(c.Z,(0,s.Z)((0,s.Z)({},e),{},{params:{login:Number(l)},children:(0,A.jsx)(i.Z,{sx:{}})}))}),(0,A.jsx)(o.Z,{spacing:1,sx:{ml:1,flexGrow:1,height:"100%"},children:a?(0,A.jsx)(S,{accountId:a,login:l}):(0,A.jsx)(D,{})})]})}}}]);